(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     34624,        893]
NotebookOptionsPosition[     33836,        864]
NotebookOutlinePosition[     34169,        879]
CellTagsIndexPosition[     34126,        876]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"coords", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], ";"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "[", "coords", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rplus", " ", "=", " ", 
   RowBox[{"M", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"M", "^", "2"}], "-", 
      RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{
    RowBox[{"2", " ", "M", " ", 
     RowBox[{"r", "/", "\[Rho]"}]}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", 
   RowBox[{"\[Rho]", "/", "\[CapitalDelta]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]\[Theta]", "=", "\[Rho]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]\[Phi]", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[CapitalDelta]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", "M", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "^", "2"}], "+", 
           RowBox[{"a", "^", "2"}]}], ")"}]}], ")"}], "/", "\[Rho]"}]}], 
     ")"}], 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t\[Phi]", "=", 
   RowBox[{
    RowBox[{"+", "4"}], " ", "a", " ", "M", " ", "r", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], "/", "\[Rho]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tt", ",", "0", ",", "0", ",", "t\[Phi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "rr", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Theta]\[Theta]", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"t\[Phi]", ",", "0", ",", "0", ",", "\[Phi]\[Phi]"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inversemetric", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "metric", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inversemetric", " ", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.635832972239127*^9, 3.635832998932214*^9}, {
  3.63583304962444*^9, 3.635833053086396*^9}, {3.635838146327413*^9, 
  3.635838152689741*^9}, {3.6358494583669863`*^9, 3.6358494843140993`*^9}, {
  3.639220338620221*^9, 3.639220338885933*^9}, {3.6392250764718437`*^9, 
  3.639225078260078*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=."}], ";", 
  RowBox[{"M", "=."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{
    RowBox[{"r", "^", "2"}], "+", 
    RowBox[{
     RowBox[{"a", "^", "2"}], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", 
   RowBox[{
    RowBox[{"r", "^", "2"}], " ", "-", " ", 
    RowBox[{"2", " ", "M", " ", "r"}], "+", " ", 
    RowBox[{"a", "^", "2"}]}]}], ";"}], "\n", 
 RowBox[{"christoffel", ":=", 
  RowBox[{"christoffel", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"inversemetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "+", 
            "\[IndentingNewLine]", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], " ", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}], "\n", 
 RowBox[{"listchristoffel", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"christoffel", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", "0"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
        RowBox[{"christoffel", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}], 
    " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "j"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"geodesic", ":=", 
  RowBox[{"geodesic", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"christoffel", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "'"}], " ", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "'"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"listgeodesic", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<d/d\[Tau]\>\"", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"coords", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "'"}], "]"}]}], ",", "\"\<=\>\"", 
      ",", 
      RowBox[{"geodesic", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"geodesic", ":=", 
  RowBox[{"geodesic", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"christoffel", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "'"}], " ", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "'"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.635833107468111*^9, 3.635833135655171*^9}, {
  3.635833176447451*^9, 3.635833176643635*^9}, {3.635838157037478*^9, 
  3.635838183876686*^9}, {3.635838223449452*^9, 3.6358382514925947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "solver", " ", 
     RowBox[{"function", ".", " ", "It"}], " ", "takes", " ", "in", " ", 
     "the", " ", "max", " ", "\[Tau]"}], ",", " ", 
    RowBox[{"the", " ", "initial", " ", "velocities", " ", "in", " ", "r"}], 
    ",", "\[Theta]", ",", 
    RowBox[{
    "\[Phi]", " ", "and", " ", "the", " ", "initial", " ", "coordinates", " ",
      "in", " ", "t"}], ",", "r", ",", "\[Theta]", ",", 
    RowBox[{"\[Phi]", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"computeSoln", "[", 
    RowBox[{"max\[Tau]i_", ",", "ivsi_", ",", "icsi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ivs", ",", "ics", ",", "i", ",", "\[Chi]", ",", "tmp", ",", "soln"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ics", "=", "icsi"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ivs", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[Chi]", "}"}], ",", "ivsi"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", "metric"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
           RowBox[{"ics", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"ivs", ".", 
        RowBox[{"(", 
         RowBox[{"tmp", ".", "ivs"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]end", " ", "=", " ", "max\[Tau]i"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Chi]slv", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"tmp", "\[Equal]", "uinvar"}], ",", "\[Chi]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ivs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"Last", "[", 
        RowBox[{"\[Chi]", "/.", "\[Chi]slv"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deq", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "''"}], "[", "\[Tau]", "]"}], 
          "\[Equal]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"geodesic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"coords", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "'"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "'"}], "[", "\[Tau]", 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"coords", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", "\[Tau]", "]"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}],
            ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deq", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"deq", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"coords", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "'"}], "[", "0", "]"}], 
            "\[Equal]", 
            RowBox[{"ivs", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", "0", "]"}], "\[Equal]", 
            RowBox[{"ics", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"deq", ",", "coords", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", ",", "0", ",", "max\[Tau]i"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<EventLocator\>\"", ",", 
            RowBox[{"\"\<Event\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"r", "[", "\[Tau]", "]"}], "\[LessEqual]", 
               RowBox[{"1.01", "*", "rplus"}]}], ")"}]}], ",", 
            RowBox[{"\"\<EventAction\>\"", "\[RuleDelayed]", 
             RowBox[{"Throw", "[", 
              RowBox[{
               RowBox[{"\[Tau]end", "=", "\[Tau]"}], ",", 
               "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "soln"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.635836860940906*^9, 3.635836882188463*^9}, {
   3.635838260823153*^9, 3.635838403750638*^9}, {3.635842479369845*^9, 
   3.6358425288423557`*^9}, {3.635842595846592*^9, 3.635842596731579*^9}, {
   3.635842651575425*^9, 3.6358426730910177`*^9}, {3.635843246146776*^9, 
   3.63584329469384*^9}, {3.635843493989564*^9, 3.6358434984709387`*^9}, {
   3.635843646075302*^9, 3.6358436510997458`*^9}, {3.635843769043*^9, 
   3.635843808026513*^9}, 3.635843854974348*^9, {3.6358439708134747`*^9, 
   3.6358439988014507`*^9}, {3.6358440954729156`*^9, 3.635844105881661*^9}, {
   3.635847607262068*^9, 3.63584768234691*^9}, 3.635847826815672*^9, {
   3.6358481119787903`*^9, 3.635848113543921*^9}, {3.6358487677592087`*^9, 
   3.635848790637149*^9}, {3.635848847785487*^9, 3.6358488640411177`*^9}, {
   3.635848894436006*^9, 3.635848924218313*^9}, {3.6358489570376863`*^9, 
   3.6358489654812*^9}, {3.635849006413458*^9, 3.635849007501276*^9}, {
   3.635849233710607*^9, 3.6358493599152517`*^9}, {3.635849408340809*^9, 
   3.635849451683923*^9}, {3.6358495610251207`*^9, 3.635849564841069*^9}, {
   3.635849867772031*^9, 3.635849868864263*^9}, {3.635850009287113*^9, 
   3.635850015014991*^9}, {3.635850066201453*^9, 3.635850072334169*^9}, {
   3.635850715478093*^9, 3.635850729643889*^9}, {3.635850890516655*^9, 
   3.63585089065094*^9}, {3.635850927741934*^9, 3.635850930904743*^9}, {
   3.635850964732492*^9, 3.635850979076275*^9}, {3.635851070443658*^9, 
   3.635851070552003*^9}, {3.6358549984640493`*^9, 3.635855011452649*^9}, {
   3.63585662588061*^9, 3.635856628803978*^9}, {3.6358595940958843`*^9, 
   3.635859645331695*^9}, 3.6358610806165133`*^9, {3.635861698469327*^9, 
   3.635861703544375*^9}, {3.6358620847447653`*^9, 3.635862111365858*^9}, {
   3.635862187554502*^9, 3.6358621900417213`*^9}, {3.635862670603159*^9, 
   3.635862689709435*^9}, {3.63586294103659*^9, 3.635862941128776*^9}, {
   3.635862978853428*^9, 3.6358629789702177`*^9}, {3.6359168287322493`*^9, 
   3.635916856500063*^9}, {3.6359168974062157`*^9, 3.635916899247558*^9}, {
   3.636099466635062*^9, 3.636099467080287*^9}, {3.636099593301087*^9, 
   3.636099605063566*^9}, {3.6392179643300257`*^9, 3.63921796527419*^9}, {
   3.6392222078483543`*^9, 3.63922220798855*^9}, {3.639228151558065*^9, 
   3.63922815166959*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hitOrMiss", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "\[Alpha]in_", ",", "\[Beta]in_"}],
    "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "'"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]in", "]"}], 
       RowBox[{"Cos", "[", "\[Beta]in", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "'"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]in", "]"}], 
       RowBox[{"Sin", "[", "\[Beta]in", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "'"}], " ", "=", " ", 
      RowBox[{"Cos", "[", "\[Alpha]in", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u\[Theta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"x", "'"}], 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"\[Phi]\[Phi]", " ", "/.", " ", 
          RowBox[{"r", " ", "\[Rule]", " ", 
           RowBox[{"ics", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "/.", " ", 
         RowBox[{"\[Theta]", " ", "\[Rule]", " ", 
          RowBox[{"ics", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u\[Phi]", " ", "=", " ", 
      RowBox[{
       RowBox[{"y", "'"}], " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"\[Theta]\[Theta]", " ", "/.", " ", 
          RowBox[{"r", "\[Rule]", " ", 
           RowBox[{"ics", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "/.", " ", 
         RowBox[{"\[Theta]", " ", "\[Rule]", " ", 
          RowBox[{"ics", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ur", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"z", "'"}]}], 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"rr", " ", "/.", " ", 
          RowBox[{"r", "\[Rule]", " ", 
           RowBox[{"ics", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "/.", " ", 
         RowBox[{"\[Theta]", " ", "\[Rule]", " ", 
          RowBox[{"ics", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ivs", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"ur", ",", "u\[Theta]", ",", "u\[Phi]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "ivs", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivs", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", "0", ",", "1"}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6392215027884893`*^9, 3.639221603250779*^9}, {
  3.639221647907632*^9, 3.63922175422952*^9}, {3.639222260879463*^9, 
  3.639222286277398*^9}, {3.6392250167747726`*^9, 3.639225070895371*^9}, {
  3.6392251335363293`*^9, 3.639225238111659*^9}, {3.639225973300232*^9, 
  3.639225985873898*^9}, {3.639226258146586*^9, 3.639226258298048*^9}, {
  3.6392276130858717`*^9, 3.639227615793893*^9}, {3.6392276642879467`*^9, 
  3.6392276658899117`*^9}, {3.639228383761881*^9, 3.639228444307466*^9}, {
  3.639228526837447*^9, 3.639228529966302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"scan\[Alpha]\[Beta]", "[", 
   RowBox[{"max\[Tau]_", ",", "icsin_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
        RowBox[{"hitOrMiss", "[", 
         RowBox[{"max\[Tau]", ",", "icsin", ",", "\[Alpha]", ",", "\[Beta]"}],
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "4"}], ",", 
        RowBox[{"\[Pi]", "/", "4"}], ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", "0.1"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6392215027884893`*^9, 3.639221603250779*^9}, {
  3.639221647907632*^9, 3.63922175422952*^9}, {3.639222260879463*^9, 
  3.639222286277398*^9}, {3.6392250167747726`*^9, 3.639225070895371*^9}, {
  3.6392251335363293`*^9, 3.639225238111659*^9}, {3.639225973300232*^9, 
  3.639226181439109*^9}, {3.639226212758389*^9, 3.639226215549511*^9}, {
  3.639226556315916*^9, 3.639226558688271*^9}, {3.6392271102745237`*^9, 
  3.639227112879858*^9}, {3.6392272872879333`*^9, 3.639227288909215*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", "1"}], ";", 
  RowBox[{"a", "=", "M"}], ";", 
  RowBox[{"uinvar", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ics", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", 
     RowBox[{"\[Pi]", "/", "2"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"hitOrMiss", "[", 
  RowBox[{"500", ",", "ics", ",", "1", ",", 
   RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6392216963929863`*^9, 3.639221708068787*^9}, {
   3.639221762298931*^9, 3.639221771247053*^9}, {3.639221854511834*^9, 
   3.63922187116891*^9}, {3.639222121568513*^9, 3.639222215710621*^9}, {
   3.639222344179783*^9, 3.639222344527852*^9}, {3.639223374511299*^9, 
   3.639223413335327*^9}, {3.639225231745285*^9, 3.6392252440045223`*^9}, {
   3.63922544173402*^9, 3.6392254418327503`*^9}, {3.6392258873637*^9, 
   3.639225941414873*^9}, 3.63922599004554*^9, {3.6392266157954197`*^9, 
   3.639226629437667*^9}, {3.639227511293335*^9, 3.639227579068102*^9}, {
   3.639227625726059*^9, 3.639227647254003*^9}, {3.639228489412146*^9, 
   3.639228489796382*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6392285349184713`*^9, 3.639229642886195*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"scan", "=", 
   RowBox[{"scan\[Alpha]\[Beta]", "[", 
    RowBox[{"500", ",", "ics"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6392261460797987`*^9, 3.63922618838236*^9}, {
   3.63922630168934*^9, 3.6392263356649237`*^9}, {3.639226374841831*^9, 
   3.639226383508807*^9}, 3.6392284542887907`*^9, 3.639228557928321*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]s", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"scan", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "scan", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]s", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"scan", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"scan", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6392261460797987`*^9, 3.63922618838236*^9}, {
   3.63922630168934*^9, 3.639226372470786*^9}, {3.639226432913989*^9, 
   3.639226532224052*^9}, {3.639226716368511*^9, 3.639226717647756*^9}, {
   3.639226752250833*^9, 3.639226760495542*^9}, {3.6392270147194366`*^9, 
   3.639227101206327*^9}, {3.639227228794964*^9, 3.639227280468411*^9}, {
   3.639227327876733*^9, 3.639227424256*^9}, {3.6392278385775423`*^9, 
   3.639227895441367*^9}, 3.639228043733151*^9, {3.639228095033946*^9, 
   3.639228098044602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xyScan", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Beta]s", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Beta]s", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"scan", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Alpha]s", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Beta]s", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6392261460797987`*^9, 3.63922618838236*^9}, {
  3.63922630168934*^9, 3.639226372470786*^9}, {3.639226432913989*^9, 
  3.639226532224052*^9}, {3.639226716368511*^9, 3.639226717647756*^9}, {
  3.639226752250833*^9, 3.639226760495542*^9}, {3.6392270147194366`*^9, 
  3.639227101206327*^9}, {3.639227228794964*^9, 3.639227280468411*^9}, {
  3.639227327876733*^9, 3.639227424256*^9}, {3.6392278385775423`*^9, 
  3.639227910911623*^9}, {3.639228053881487*^9, 3.639228056478004*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ics", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", 
     RowBox[{"\[Pi]", "/", "2"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"hitOrMiss", "[", 
         RowBox[{"500", ",", "ics", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], 
        "\[Equal]", "1"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
            RowBox[{"Sin", "[", "\[Beta]", "]"}]}]}], "}"}], "}"}], "]"}], 
       ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "4"}], ",", 
       RowBox[{"\[Pi]", "/", "4"}], ",", "0.05"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}], ",", "0.05"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Pi]", "/", "4"}], "]"}]}], ",", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Pi]", "/", "4"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Pi]", "/", "4"}], "]"}]}], ",", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Pi]", "/", "4"}], "]"}]}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.639228563195516*^9, 3.6392285661967697`*^9}, {
   3.6392286230925093`*^9, 3.639228729151722*^9}, {3.639228898980452*^9, 
   3.639228900755143*^9}, 3.6392292496042624`*^9, {3.639229593861993*^9, 
   3.63922963233951*^9}, {3.639229691238276*^9, 3.6392297734200497`*^9}, {
   3.639229842001425*^9, 3.639229962050702*^9}, {3.639230052927487*^9, 
   3.6392301135845013`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, \
{}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, \
{}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, \
{{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, \
{}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, \
{}}, {{}, {}, {}}, {{}, {}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{-0.1379496896414715, -0.1379496896414715}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{0., -0.19509032201612828`}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{
      0.1379496896414715, -0.1379496896414715}}]}, {}}, {{}, {}, {}}, {{}, \
{}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], PointBox[{{0., 0.}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{0., 
      0.}}]}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, \
{{}, {}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{-0.1379496896414715, -0.1379496896414715}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{0., -0.19509032201612828`}}]}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{
      0.1379496896414715, -0.1379496896414715}}]}, {}}, {{}, {}, {}}, {{}, \
{}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, \
{}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, \
{{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, \
{}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, \
{}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}, {{}, {}, {}}},
  AlignmentPoint->Center,
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FormatType:>TraditionalForm,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->{},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  FrameTicksStyle->{},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Method->{"MessagesHead" -> ListPlot},
  PlotLabel->None,
  PlotRange->
   NCache[{{-2^Rational[-1, 2], 2^Rational[-1, 2]}, {-2^Rational[-1, 2], 2^
      Rational[-1, 2]}}, {{-0.7071067811865475, 
    0.7071067811865475}, {-0.7071067811865475, 0.7071067811865475}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotateLabel->True,
  Ticks->{Automatic, Automatic},
  TicksStyle->{}]], "Output",
 CellChangeTimes->{3.639230089214951*^9}]
}, Open  ]]
},
WindowSize->{1366, 747},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 286, 5, 32, "Input"],
Cell[846, 27, 2746, 79, 275, "Input"],
Cell[3595, 108, 5652, 165, 297, "Input"],
Cell[9250, 275, 8057, 180, 451, "Input"],
Cell[17310, 457, 3448, 85, 253, "Input"],
Cell[20761, 544, 1343, 29, 77, "Input"],
Cell[CellGroupData[{
Cell[22129, 577, 1139, 23, 77, "Input"],
Cell[23271, 602, 94, 1, 32, "Output"]
}, Open  ]],
Cell[23380, 606, 360, 7, 32, "Input"],
Cell[23743, 615, 1397, 36, 55, "Input"],
Cell[25143, 653, 1521, 37, 32, "Input"],
Cell[CellGroupData[{
Cell[26689, 694, 2375, 65, 165, "Input"],
Cell[29067, 761, 4753, 100, 238, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
