(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     86430,       2135]
NotebookOptionsPosition[     84239,       2068]
NotebookOutlinePosition[     84571,       2083]
CellTagsIndexPosition[     84528,       2080]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, 3.639822707820517*^9, {
   3.6430838025169783`*^9, 3.643083815386147*^9}, {3.643083848300701*^9, 
   3.643083903224534*^9}, {3.643084169201158*^9, 3.643084169416102*^9}, {
   3.6430842168645887`*^9, 3.643084305270853*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<KBHSH1.dat\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
      "Number", ",", "Number", ",", "Number", ",", "Number", ",", "Number", 
       ",", "Number", ",", "Number"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nx", "=", "251"}], ";", 
  RowBox[{"ny", "=", "30"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xmax", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"251", ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"xmin", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ymax", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"nx", "*", "ny"}], ",", "2"}], "]"}], "]"}]}], ";", 
  RowBox[{"ymin", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rh", "=", "0.2"}], ";", 
  RowBox[{"OmegaH", "=", "0.975"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822725387351*^9}, {3.639830860861123*^9, 3.639830889540786*^9}, 
   3.639831723375119*^9, {3.639839940064301*^9, 3.639839941393813*^9}, {
   3.6431923251760798`*^9, 3.6431923432165413`*^9}, {3.643194997378975*^9, 
   3.643195012619728*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cts", " ", "=", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{"OmegaH", "==", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"x", "-", "rh"}], ")"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rh", "-", "x"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"rh", "-", 
           RowBox[{"2", "x"}]}], ")"}]}], ")"}]}]}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ct", "=", 
   RowBox[{"cts", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822725387351*^9}, {3.639830860861123*^9, 3.639830889540786*^9}, {
   3.639831723375119*^9, 3.639831761746402*^9}, {3.639831813741714*^9, 
   3.63983183547808*^9}, {3.639831891974791*^9, 3.639831899397504*^9}, {
   3.63983193066028*^9, 3.6398319311946*^9}, 3.63983292684643*^9, {
   3.639832959672049*^9, 3.6398329598109913`*^9}, {3.6398331227543907`*^9, 
   3.639833122823901*^9}, {3.639833308100128*^9, 3.639833308239058*^9}, {
   3.63983412451503*^9, 3.639834128991078*^9}, {3.639893481910615*^9, 
   3.639893485027893*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"M", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"rh", "-", 
     RowBox[{"2", "ct"}]}], ")"}], "/", "2.0"}]}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"ct", 
     RowBox[{"(", 
      RowBox[{"ct", "-", "rh"}], ")"}]}], "]"}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"rh", "-", 
       RowBox[{"2", "ct"}]}], ")"}], "/", "2"}], "/", 
    "M"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"a", "/", "M"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RH", " ", "=", " ", 
   RowBox[{"M", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"M", "^", "2"}], "-", 
      RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822725387351*^9}, {3.639830860861123*^9, 3.639830889540786*^9}, {
   3.639831723375119*^9, 3.639831726109757*^9}, {3.639831839076281*^9, 
   3.639831845690996*^9}, {3.639833607959386*^9, 3.639833609001396*^9}}],

Cell[BoxData["0.3962188154403773`"], "Output",
 CellChangeTimes->{
  3.639831841755728*^9, 3.639831933187561*^9, 3.639832258223995*^9, 
   3.6398323266620407`*^9, 3.639832361067547*^9, 3.639832430164616*^9, 
   3.639832696196529*^9, 3.6398328647288733`*^9, {3.639832965206291*^9, 
   3.6398329913868933`*^9}, 3.6398331241074057`*^9, 3.639833188368387*^9, 
   3.639833265914466*^9, {3.639833604228427*^9, 3.6398336094845257`*^9}, 
   3.63983379796813*^9, 3.639833834112484*^9, 3.639833935411751*^9, 
   3.6398339719123297`*^9, 3.6398341327754583`*^9, 3.639835163743745*^9, 
   3.6398354460947237`*^9, 3.63983683650394*^9, 3.639837692872348*^9, 
   3.6398378234593153`*^9, {3.639839931297298*^9, 3.639839952638425*^9}, 
   3.639840107470357*^9, 3.639914421762919*^9, 3.6399147517942533`*^9, 
   3.639917112101654*^9, 3.639917284507517*^9, 3.6399178505463753`*^9, 
   3.639919839445447*^9, 3.63991994822606*^9, 3.639920032564354*^9, 
   3.639921400445014*^9, 3.639921569423779*^9, 3.639921777201768*^9, 
   3.639921865233726*^9, 3.643078707596838*^9, 3.6430796539398613`*^9, 
   3.643080944103545*^9, 3.643082734567988*^9, 3.643082987932913*^9, 
   3.64308390787309*^9, 3.64308420211966*^9, 3.6430842780089808`*^9, 
   3.6430844513000183`*^9, 3.643084868868802*^9, 3.6430849466010647`*^9, 
   3.643085105487336*^9, 3.643085155334139*^9, {3.643085249237899*^9, 
   3.6430852849389753`*^9}, 3.643085323605646*^9, 3.643086198586611*^9, 
   3.643177575757725*^9, 3.6431923455878773`*^9, 3.643193306132629*^9, 
   3.6433660363816566`*^9}],

Cell[BoxData["0.38339190094337644`"], "Output",
 CellChangeTimes->{
  3.639831841755728*^9, 3.639831933187561*^9, 3.639832258223995*^9, 
   3.6398323266620407`*^9, 3.639832361067547*^9, 3.639832430164616*^9, 
   3.639832696196529*^9, 3.6398328647288733`*^9, {3.639832965206291*^9, 
   3.6398329913868933`*^9}, 3.6398331241074057`*^9, 3.639833188368387*^9, 
   3.639833265914466*^9, {3.639833604228427*^9, 3.6398336094845257`*^9}, 
   3.63983379796813*^9, 3.639833834112484*^9, 3.639833935411751*^9, 
   3.6398339719123297`*^9, 3.6398341327754583`*^9, 3.639835163743745*^9, 
   3.6398354460947237`*^9, 3.63983683650394*^9, 3.639837692872348*^9, 
   3.6398378234593153`*^9, {3.639839931297298*^9, 3.639839952638425*^9}, 
   3.639840107470357*^9, 3.639914421762919*^9, 3.6399147517942533`*^9, 
   3.639917112101654*^9, 3.639917284507517*^9, 3.6399178505463753`*^9, 
   3.639919839445447*^9, 3.63991994822606*^9, 3.639920032564354*^9, 
   3.639921400445014*^9, 3.639921569423779*^9, 3.639921777201768*^9, 
   3.639921865233726*^9, 3.643078707596838*^9, 3.6430796539398613`*^9, 
   3.643080944103545*^9, 3.643082734567988*^9, 3.643082987932913*^9, 
   3.64308390787309*^9, 3.64308420211966*^9, 3.6430842780089808`*^9, 
   3.6430844513000183`*^9, 3.643084868868802*^9, 3.6430849466010647`*^9, 
   3.643085105487336*^9, 3.643085155334139*^9, {3.643085249237899*^9, 
   3.6430852849389753`*^9}, 3.643085323605646*^9, 3.643086198586611*^9, 
   3.643177575757725*^9, 3.6431923455878773`*^9, 3.643193306132629*^9, 
   3.643366036383374*^9}],

Cell[BoxData["0.967626690108736`"], "Output",
 CellChangeTimes->{
  3.639831841755728*^9, 3.639831933187561*^9, 3.639832258223995*^9, 
   3.6398323266620407`*^9, 3.639832361067547*^9, 3.639832430164616*^9, 
   3.639832696196529*^9, 3.6398328647288733`*^9, {3.639832965206291*^9, 
   3.6398329913868933`*^9}, 3.6398331241074057`*^9, 3.639833188368387*^9, 
   3.639833265914466*^9, {3.639833604228427*^9, 3.6398336094845257`*^9}, 
   3.63983379796813*^9, 3.639833834112484*^9, 3.639833935411751*^9, 
   3.6398339719123297`*^9, 3.6398341327754583`*^9, 3.639835163743745*^9, 
   3.6398354460947237`*^9, 3.63983683650394*^9, 3.639837692872348*^9, 
   3.6398378234593153`*^9, {3.639839931297298*^9, 3.639839952638425*^9}, 
   3.639840107470357*^9, 3.639914421762919*^9, 3.6399147517942533`*^9, 
   3.639917112101654*^9, 3.639917284507517*^9, 3.6399178505463753`*^9, 
   3.639919839445447*^9, 3.63991994822606*^9, 3.639920032564354*^9, 
   3.639921400445014*^9, 3.639921569423779*^9, 3.639921777201768*^9, 
   3.639921865233726*^9, 3.643078707596838*^9, 3.6430796539398613`*^9, 
   3.643080944103545*^9, 3.643082734567988*^9, 3.643082987932913*^9, 
   3.64308390787309*^9, 3.64308420211966*^9, 3.6430842780089808`*^9, 
   3.6430844513000183`*^9, 3.643084868868802*^9, 3.6430849466010647`*^9, 
   3.643085105487336*^9, 3.643085155334139*^9, {3.643085249237899*^9, 
   3.6430852849389753`*^9}, 3.643085323605646*^9, 3.643086198586611*^9, 
   3.643177575757725*^9, 3.6431923455878773`*^9, 3.643193306132629*^9, 
   3.643366036385035*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Xtor", "[", "X_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"X", "\[NotEqual]", "1"}], ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"X", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "X"}], ")"}]}], ")"}], "^", "2"}], "]"}], ",", 
    "1000"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822726841851*^9}, {3.6398332616635113`*^9, 3.63983326225282*^9}, {
   3.639833362208622*^9, 3.6398333655501213`*^9}, {3.6398336337536488`*^9, 
   3.6398336692771997`*^9}, {3.639833930276513*^9, 3.639833930892625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "3"}], 
           "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "4"}], 
           "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "5"}], 
           "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "7"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "r_", "]"}], ":=", 
   RowBox[{"1", "-", 
    FractionBox["rh", "r"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.6398227520874777`*^9}, {3.639822831235125*^9, 3.639822831440844*^9}, 
   3.6398331788075447`*^9, {3.639834903371584*^9, 3.639834907762121*^9}, {
   3.639834943373888*^9, 3.63983495701792*^9}, {3.643193302306938*^9, 
   3.643193302418345*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"[", 
      RowBox[{"ny", ",", "All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], ",", "5"}], "]"}]}], " ", ";", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mathematica", " ", "being", " ", "silly"}], "..."}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"f1", "[", 
    RowBox[{"[", 
     RowBox[{"ny", ",", "All", ",", "2"}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.643080805224175*^9, 3.643080858584353*^9}, 
   3.643082727054243*^9, {3.643084872338292*^9, 3.643084942620863*^9}, {
   3.6430850928492517`*^9, 3.643085119343027*^9}, {3.643085262518263*^9, 
   3.643085280366884*^9}, {3.643085313620223*^9, 3.643085319129517*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"if1", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f1", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"if2", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f2", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"if0", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f0", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"iW", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"W", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822752806066*^9}, 3.639822989696681*^9, {3.639833368619607*^9, 
   3.639833369330338*^9}, {3.63983382516892*^9, 3.639833838952847*^9}, 
   3.639833962247724*^9, {3.6398376683598347`*^9, 3.639837670529829*^9}, {
   3.639837807619858*^9, 3.63983780973603*^9}, {3.643085299239916*^9, 
   3.6430853044330997`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", " ", "=", " ", "if1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", "if2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f0", "=", "if0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", "iW"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822752806066*^9}, {3.639822989696681*^9, 3.6398230078896217`*^9}, {
   3.639832199850816*^9, 3.639832253391707*^9}, {3.639832495022564*^9, 
   3.6398325013765917`*^9}, {3.6398327202069883`*^9, 3.6398327265897837`*^9}, 
   3.639833064026441*^9, 3.639833277388864*^9, 3.643080717732829*^9, 
   3.643080896947268*^9, 3.6430882114055977`*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"coords", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], ";"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "[", "coords", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"f0", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "*", " ", 
     RowBox[{"H", "[", "r", "]"}]}], "+", " ", 
    RowBox[{
     RowBox[{"f2", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "*", 
     RowBox[{"r", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", 
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "/", 
    RowBox[{"H", "[", "r", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]\[Theta]", "=", 
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "*", 
    RowBox[{"r", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]\[Phi]", "=", 
   RowBox[{
    RowBox[{"f2", "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "*", " ", 
    RowBox[{"r", "^", "2"}], "*", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t\[Phi]", "=", 
    RowBox[{
     RowBox[{"+", 
      RowBox[{"f2", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "*", 
     RowBox[{"r", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], 
     RowBox[{"W", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tt", ",", "0", ",", "0", ",", "t\[Phi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "rr", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Theta]\[Theta]", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"t\[Phi]", ",", "0", ",", "0", ",", "\[Phi]\[Phi]"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inversemetric", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "metric", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inversemetric", " ", "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rtor", "[", "R_", "]"}], " ", ":=", " ", 
   RowBox[{"R", " ", "-", " ", 
    RowBox[{
     RowBox[{"a", "^", "2"}], "/", "RH"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.635832972239127*^9, 3.635832998932214*^9}, {
   3.63583304962444*^9, 3.635833053086396*^9}, {3.635838146327413*^9, 
   3.635838152689741*^9}, {3.6358494583669863`*^9, 3.6358494843140993`*^9}, {
   3.6361195470004463`*^9, 3.63611966162027*^9}, {3.636119706112146*^9, 
   3.636119762925138*^9}, {3.636120587524517*^9, 3.636120589186108*^9}, 
   3.636127119640697*^9, 3.636127159728249*^9, {3.636183592307225*^9, 
   3.636183602101941*^9}, {3.636183650302887*^9, 3.636183662475609*^9}, {
   3.636183727781934*^9, 3.636183728925796*^9}, {3.636186424705222*^9, 
   3.636186427316784*^9}, {3.636186558115234*^9, 3.636186623067778*^9}, {
   3.636186683801738*^9, 3.636186711083069*^9}, {3.636188372579583*^9, 
   3.636188374074327*^9}, {3.639306849434944*^9, 3.639306850348048*^9}, {
   3.6393134334714622`*^9, 3.6393134348170156`*^9}, {3.639313505886211*^9, 
   3.639313511963009*^9}, 3.639392145221756*^9, {3.639822948944982*^9, 
   3.639822987265823*^9}, {3.639823170413929*^9, 3.639823216581032*^9}, {
   3.63982325862799*^9, 3.6398232625037537`*^9}, {3.639832396700183*^9, 
   3.639832425117262*^9}, {3.639832733495761*^9, 3.6398327423146553`*^9}, {
   3.643079648849495*^9, 3.643079649114996*^9}, 3.643082636399659*^9}],

Cell[BoxData[{
 RowBox[{"christoffel", ":=", 
  RowBox[{"christoffel", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"inversemetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], "\n", 
 RowBox[{"geodesic", ":=", 
  RowBox[{"geodesic", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"christoffel", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "'"}], " ", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "'"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.635832972239127*^9, 3.635832998932214*^9}, {
   3.63583304962444*^9, 3.635833053086396*^9}, {3.635838146327413*^9, 
   3.635838152689741*^9}, {3.6358494583669863`*^9, 3.6358494843140993`*^9}, {
   3.6361195470004463`*^9, 3.63611966162027*^9}, {3.636119706112146*^9, 
   3.636119762925138*^9}, {3.636120587524517*^9, 3.636120589186108*^9}, 
   3.636127119640697*^9, 3.636127159728249*^9, {3.636183592307225*^9, 
   3.636183602101941*^9}, {3.636183650302887*^9, 3.636183662475609*^9}, {
   3.636183727781934*^9, 3.636183728925796*^9}, {3.636186424705222*^9, 
   3.636186427316784*^9}, {3.636186558115234*^9, 3.636186623067778*^9}, {
   3.636186683801738*^9, 3.636186711083069*^9}, {3.636188372579583*^9, 
   3.636188374074327*^9}, {3.639306849434944*^9, 3.639306850348048*^9}, {
   3.6393134334714622`*^9, 3.6393134348170156`*^9}, {3.639313505886211*^9, 
   3.639313511963009*^9}, {3.639392145221756*^9, 3.6393921460011053`*^9}, 
   3.639823153042695*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "solver", " ", 
     RowBox[{"function", ".", " ", "It"}], " ", "takes", " ", "in", " ", 
     "the", " ", "max", " ", "\[Tau]"}], ",", " ", 
    RowBox[{"the", " ", "initial", " ", "velocities", " ", "in", " ", "r"}], 
    ",", "\[Theta]", ",", 
    RowBox[{
    "\[Phi]", " ", "and", " ", "the", " ", "initial", " ", "coordinates", " ",
      "in", " ", "t"}], ",", "r", ",", "\[Theta]", ",", 
    RowBox[{
     RowBox[{"\[Phi]", ".", " ", "\[IndentingNewLine]", "it"}], " ", 
     "calculates", " ", "whether", " ", "the", " ", "trajectory", " ", "is", 
     " ", "timelike", " ", "or", " ", "null", " ", "from", " ", "the", " ", 
     "variable", " ", "\[Chi]", " ", "and", " ", "uinvar", " ", "which", " ", 
     "is", " ", "determined", " ", "before", " ", "\[IndentingNewLine]", 
     "calling", " ", "the", " ", "function"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"computeSoln", "[", 
     RowBox[{"max\[Tau]i_", ",", "ivsi_", ",", "icsi_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ivs", ",", "ics", ",", "i", ",", "\[Chi]", ",", "tmp", ",", "soln"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ics", "=", "icsi"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ivs", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "\[Chi]", "}"}], ",", "ivsi"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", "metric"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
            RowBox[{"ics", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"ivs", ".", 
         RowBox[{"(", 
          RowBox[{"tmp", ".", "ivs"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"\[Tau]end", " ", "=", " ", "max\[Tau]i"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Chi]slv", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"tmp", "\[Equal]", "uinvar"}], ",", "\[Chi]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ivs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"Last", "[", 
         RowBox[{"\[Chi]", "/.", "\[Chi]slv"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deq", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "''"}], "[", "\[Tau]", "]"}], 
           "\[Equal]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"geodesic", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/.", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "'"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "'"}], "[", "\[Tau]", 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"coords", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\[Tau]", "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
              "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deq", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"deq", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"coords", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "'"}], "[", "0", "]"}], 
             "\[Equal]", 
             RowBox[{"ivs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"coords", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "0", "]"}], "\[Equal]", 
             RowBox[{"ics", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{"deq", ",", "coords", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "max\[Tau]i"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<EventLocator\>\"", ",", 
             RowBox[{"\"\<Event\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"r", "[", "\[Tau]", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"1.5", "*", "rh"}]}], ")"}]}], ",", 
             RowBox[{"\"\<EventAction\>\"", "\[RuleDelayed]", 
              RowBox[{"Throw", "[", 
               RowBox[{
                RowBox[{"\[Tau]end", "=", "\[Tau]"}], ",", 
                "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "soln"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "next", " ", "function", " ", "translates", " ", "from", 
      " ", "spherical", " ", "coordinates", " ", "to", " ", "Cartesian", " ", 
      "coordinates", " ", "to", " ", "make", " ", "plotting", " ", "simpler", 
      " ", "\[IndentingNewLine]", "I", " ", "want", " ", "to", " ", "plot", 
      " ", "in", " ", "the", " ", "R"}], ",", " ", 
     RowBox[{"i", ".", "e", ".", " ", "BL"}], ",", " ", 
     RowBox[{"radial", " ", "coordinates"}], ",", " ", 
     RowBox[{"so", " ", "for", " ", "solution", " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{
      "I", " ", "have", " ", "to", " ", "translate", " ", "to", " ", "R", " ",
        "via", " ", "r"}], " ", "=", " ", 
      RowBox[{"R", " ", "-", " ", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "/", "RH"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphslnToCartsln", "[", "soln_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}], ",", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "\[Tau]", "]"}], "+", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "/", "RH"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]", "[", "\[Tau]", "]"}], "]"}]}], "/.", "soln"}]}], 
       " ", ";", 
       RowBox[{"ys", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "\[Tau]", "]"}], "+", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "/", "RH"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "[", "\[Tau]", "]"}], "]"}]}], "/.", "soln"}]}], 
       ";", 
       RowBox[{"zs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "\[Tau]", "]"}], "+", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "/", "RH"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "\[Tau]", "]"}], "]"}]}], "/.", 
         "soln"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coordlist", "[", 
     RowBox[{"\[Tau]in_", ",", "soln_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"coords", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
       RowBox[{"{", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", "\[Tau]in", "]"}], "/.", 
           "soln"}], "//", "First"}], "]"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.635836860940906*^9, 3.635836882188463*^9}, {
   3.635838260823153*^9, 3.635838403750638*^9}, {3.635842479369845*^9, 
   3.6358425288423557`*^9}, {3.635842595846592*^9, 3.635842596731579*^9}, {
   3.635842651575425*^9, 3.6358426730910177`*^9}, {3.635843246146776*^9, 
   3.63584329469384*^9}, {3.635843493989564*^9, 3.6358434984709387`*^9}, {
   3.635843646075302*^9, 3.6358436510997458`*^9}, {3.635843769043*^9, 
   3.635843808026513*^9}, 3.635843854974348*^9, {3.6358439708134747`*^9, 
   3.6358439988014507`*^9}, {3.6358440954729156`*^9, 3.635844105881661*^9}, {
   3.635847607262068*^9, 3.63584768234691*^9}, 3.635847826815672*^9, {
   3.6358481119787903`*^9, 3.635848113543921*^9}, {3.6358487677592087`*^9, 
   3.635848790637149*^9}, {3.635848847785487*^9, 3.6358488640411177`*^9}, {
   3.635848894436006*^9, 3.635848924218313*^9}, {3.6358489570376863`*^9, 
   3.6358489654812*^9}, {3.635849006413458*^9, 3.635849007501276*^9}, {
   3.635849233710607*^9, 3.6358493599152517`*^9}, {3.635849408340809*^9, 
   3.635849451683923*^9}, {3.6358495610251207`*^9, 3.635849564841069*^9}, {
   3.635849867772031*^9, 3.635849868864263*^9}, {3.635850009287113*^9, 
   3.635850015014991*^9}, {3.635850066201453*^9, 3.635850072334169*^9}, {
   3.635850715478093*^9, 3.635850729643889*^9}, {3.635850890516655*^9, 
   3.63585089065094*^9}, {3.635850927741934*^9, 3.635850930904743*^9}, {
   3.635850964732492*^9, 3.635850979076275*^9}, {3.635851070443658*^9, 
   3.635851070552003*^9}, {3.6358549984640493`*^9, 3.635855011452649*^9}, {
   3.63585662588061*^9, 3.635856628803978*^9}, {3.6358595940958843`*^9, 
   3.635859645331695*^9}, 3.6358610806165133`*^9, {3.635861698469327*^9, 
   3.635861703544375*^9}, {3.6358620847447653`*^9, 3.635862111365858*^9}, {
   3.635862187554502*^9, 3.6358621900417213`*^9}, {3.635862670603159*^9, 
   3.635862689709435*^9}, {3.63586294103659*^9, 3.635862941128776*^9}, {
   3.635862978853428*^9, 3.6358629789702177`*^9}, {3.6359168287322493`*^9, 
   3.635916856500063*^9}, {3.6359168974062157`*^9, 3.635916899247558*^9}, {
   3.636099466635062*^9, 3.636099467080287*^9}, {3.636099593301087*^9, 
   3.636099605063566*^9}, {3.636120749806033*^9, 3.636120775873435*^9}, {
   3.6361266994289093`*^9, 3.636126738310861*^9}, {3.63612684687632*^9, 
   3.6361268476711683`*^9}, {3.636184122377878*^9, 3.6361841424402742`*^9}, {
   3.636184826017067*^9, 3.636184851027627*^9}, {3.636184905181584*^9, 
   3.6361849103730173`*^9}, {3.636184983975903*^9, 3.6361849891673*^9}, {
   3.6361850881801*^9, 3.636185090855568*^9}, {3.6361855086766453`*^9, 
   3.6361855091037416`*^9}, {3.6361858063054867`*^9, 3.636185807375502*^9}, {
   3.636185850132902*^9, 3.636185853508059*^9}, {3.6361860332718573`*^9, 
   3.636186068585531*^9}, 3.636186114012312*^9, {3.6361861642688828`*^9, 
   3.636186181496447*^9}, {3.636186377465852*^9, 3.636186388308235*^9}, {
   3.6361864844781103`*^9, 3.636186509816987*^9}, {3.636186842419696*^9, 
   3.636186858287013*^9}, {3.63618696474232*^9, 3.636186969123007*^9}, {
   3.636187002588887*^9, 3.636187033977873*^9}, {3.63618737422716*^9, 
   3.636187406294132*^9}, {3.636187462763698*^9, 3.636187463898428*^9}, {
   3.63618777332952*^9, 3.6361877735703907`*^9}, {3.6361880651573143`*^9, 
   3.636188065771721*^9}, {3.6361882616314*^9, 3.636188272392351*^9}, {
   3.639306864760098*^9, 3.639306892408499*^9}, {3.639308468232663*^9, 
   3.639308514096065*^9}, {3.639313453424519*^9, 3.639313460241234*^9}, {
   3.639313584149225*^9, 3.639313618106605*^9}, {3.639838014455957*^9, 
   3.639838014653544*^9}, 3.639916795675778*^9, {3.6399168965238457`*^9, 
   3.639916896823678*^9}, {3.6399169658865833`*^9, 3.639916966513048*^9}, {
   3.63991728138739*^9, 3.6399172824761744`*^9}, {3.63991784782952*^9, 
   3.639917848169796*^9}, {3.639919836513995*^9, 3.639919836911572*^9}, {
   3.6399199441601877`*^9, 3.639919944373478*^9}, 3.639920014020954*^9, {
   3.63992154970569*^9, 3.639921550259137*^9}, {3.63992177394466*^9, 
   3.639921774104589*^9}, {3.639921861198989*^9, 3.63992186153811*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genXYPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xyz", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "Flatten"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Hue", "[", "hue", "]"}]}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genXZPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xyz", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "//", "Flatten"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "z"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Hue", "[", "hue", "]"}]}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genYZPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xyz", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "//", "Flatten"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Hue", "[", "hue", "]"}]}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genXYZPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Re", "[", "xyz", "]"}], "//", "Flatten"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Hue", "[", "hue", "]"}]}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.635918227700633*^9, 3.6359182471197147`*^9}, {
   3.635918436082766*^9, 3.635918551414887*^9}, {3.635919086418542*^9, 
   3.6359191408473873`*^9}, {3.635919892122779*^9, 3.635919904731124*^9}, {
   3.6359203287428293`*^9, 3.635920332777154*^9}, {3.635920982683012*^9, 
   3.635920983287322*^9}, 3.635921242254211*^9, {3.635921675108076*^9, 
   3.635921772203635*^9}, {3.636184149182275*^9, 3.636184169736897*^9}, {
   3.6361842274435377`*^9, 3.636184238926565*^9}, {3.636184892905513*^9, 
   3.636184901777832*^9}, {3.636185512213541*^9, 3.636185513238718*^9}, {
   3.636186866925673*^9, 3.63618692305689*^9}, {3.639306050196292*^9, 
   3.639306186562442*^9}, {3.639306514713902*^9, 3.639306556398106*^9}, 
   3.6393134664945602`*^9, {3.6393136154301453`*^9, 3.639313652526108*^9}, {
   3.639314754592531*^9, 3.639314762988352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hitOrMiss", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", 
    RowBox[{
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", 
       RowBox[{"computeSoln", "[", 
        RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "\[Equal]", "\[Tau]end"}], ",", "0", ",", "1"}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.643177555931888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bisectionEdge", "[", 
   RowBox[{
   "m\[Tau]_", ",", "icsin_", ",", "d\[Theta]in_", ",", "d\[Phi]1_", ",", 
    "d\[Phi]2_", ",", "eps_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d\[Phi]One", ",", "d\[Phi]Two", ",", "k"}], "}"}], ",", 
    RowBox[{
     RowBox[{"d\[Phi]One", "=", "d\[Phi]1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Phi]Two", "=", "d\[Phi]2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"d\[Phi]Two", "-", "d\[Phi]One"}], "]"}], "/", "2"}], ">", 
        "eps"}], ",", 
       RowBox[{
        RowBox[{"resultOne", "=", 
         RowBox[{"hitOrMiss", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", 
           RowBox[{"{", 
            RowBox[{"dr", ",", "d\[Theta]in", ",", "d\[Phi]One"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"resultTwo", "=", 
         RowBox[{"hitOrMiss", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", 
           RowBox[{"{", 
            RowBox[{"dr", ",", "d\[Theta]in", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d\[Phi]Two", "+", "d\[Phi]One"}], ")"}], "/", "2"}]}],
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"resultOne", "\[Equal]", "resultTwo"}], ",", 
          RowBox[{"d\[Phi]One", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d\[Phi]Two", "+", "d\[Phi]One"}], ")"}], "/", "2"}]}], 
          ",", 
          RowBox[{"d\[Phi]Two", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d\[Phi]Two", "+", "d\[Phi]One"}], ")"}], "/", "2"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d\[Phi]One", "+", "d\[Phi]Two"}], ")"}], "/", "2"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.643177555931888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeFinder", "[", 
   RowBox[{
   "m\[Tau]_", ",", "icsin_", ",", "d\[Theta]in_", ",", "d\[Phi]1_", ",", 
    "d\[Phi]2_", ",", "num_", ",", "eps_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "shots", ",", "stepd\[Phi]", ",", "firstEdge", ",", "secondEdge"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"stepd\[Phi]", "=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"d\[Phi]1", "-", "d\[Phi]2"}], "]"}], "/", "num"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"shots", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"hitOrMiss", "[", 
           RowBox[{"\[Tau]Value", ",", "icsin", ",", 
            RowBox[{"{", 
             RowBox[{"dr", ",", "d\[Theta]in", ",", "i"}], "}"}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "d\[Phi]1", ",", "d\[Phi]2", ",", "stepd\[Phi]"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"shots", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "shots", "]"}]}], "}"}]}], "]"}], ">", 
        "0"}], ",", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
              "\[Equal]", "1"}], ",", 
             RowBox[{"firstEdge", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
              "\[Equal]", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{"secondEdge", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}]}], "]"}]}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"Length", "[", "shots", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"leftEdge", "=", 
         RowBox[{"bisectionEdge", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", "d\[Theta]in", ",", 
           RowBox[{"firstEdge", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"firstEdge", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "eps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rightEdge", "=", 
         RowBox[{"bisectionEdge", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", "d\[Theta]in", ",", 
           RowBox[{"secondEdge", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"secondEdge", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "eps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"leftEdge", ",", "rightEdge"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "Null"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Null"}], "}"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.643177553135079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findShadow", "[", 
   RowBox[{
   "m\[Tau]_", ",", "icsin_", ",", "initial_", ",", "max_", ",", 
    "d\[Theta]max_", ",", "const_", ",", "eps_", ",", "compact_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"leftEdge", ",", "rightEdge", ",", "edges"}], "}"}], ",", 
    RowBox[{
     RowBox[{"points", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"compact", "\[Equal]", "1"}], ",", 
          RowBox[{"d\[Theta]", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "max"}], ",", "d\[Theta]max", ",", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"i", "/", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "const"}], ")"}]}], "*", "d\[Theta]max"}], 
              "]"}]}], "]"}]}], ",", 
          RowBox[{"d\[Theta]", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "max"}], ",", "d\[Theta]max", ",", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"max", "-", "i"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"max", "-", "initial"}], ")"}]}]}], ")"}], "*", 
               "d\[Theta]max"}], "]"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edges", "=", 
         RowBox[{"edgeFinder", "[", 
          RowBox[{
          "m\[Tau]", ",", "icsin", ",", "d\[Theta]", ",", "d\[Phi]1", ",", 
           "d\[Phi]2", ",", "num", ",", "eps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"leftEdge", "=", 
         RowBox[{"edges", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rightEdge", "=", 
         RowBox[{"edges", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"num", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"i", ",", "3"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{"num", "=", 
              RowBox[{"num", "+", "1"}]}], ",", "num"}], "]"}]}], ";"}], 
         "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"leftEdge", "=!=", "Null"}], "&&", 
           RowBox[{"rightEdge", "=!=", "Null"}]}], ",", 
          RowBox[{
           RowBox[{"d\[Phi]1", "=", "leftEdge"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"d\[Phi]2", "=", "rightEdge"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"d\[Phi]1", ",", "d\[Theta]"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"d\[Phi]2", ",", "d\[Theta]"}], "}"}]}], "]"}], ";"}], 
          ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "initial", ",", "max"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "points", "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.64317754783072*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Tau]end", "=."}], ";", 
  RowBox[{"uinvar", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"M", "=", "0.415392"}], ";", 
  RowBox[{"a", "=", "0.414068"}], ";", 
  RowBox[{"rplus", "=", 
   RowBox[{"M", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"M", "^", "2"}], "-", 
      RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ics", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Rtor", "[", "12", "]"}], ",", 
     RowBox[{"\[Pi]", "/", "2"}], ",", 
     RowBox[{"\[Pi]", "/", "4"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"num", "=", "20"}], ";", 
  RowBox[{"(*", 
   RowBox[{"from", " ", "10", " ", "to", " ", "20", " ", 
    RowBox[{"didn", "'"}], "t", " ", "increase", " ", "computation", " ", 
    "time", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"eps", "=", "10*^-10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Tau]Value", "=", "500"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dr", "=", 
   RowBox[{"-", "0.15"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d\[Phi]1", "=", 
   RowBox[{"-", "0.05"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "increasing", " ", "here", " ", "makes", " ", "trouble", " ", "if", " ", 
     "the", " ", "number", " ", "of", " ", "points"}], ",", 
    RowBox[{"in", " ", "num"}], ",", 
    RowBox[{
     RowBox[{"don", "'"}], "t", " ", "manage", " ", "to", " ", "hit", " ", 
     "the", " ", "width", " ", "of", " ", "the", " ", "shadow"}]}], "*)"}], 
  RowBox[{"d\[Phi]2", "=", "0.05"}], ";"}]}], "Input",
 CellChangeTimes->{{3.64317756819293*^9, 3.643177569656849*^9}, 
   3.643177974016943*^9, {3.6433660482452*^9, 3.6433660522826014`*^9}, 
   3.64336612362414*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"initial1", "=", "0"}], ";", 
  RowBox[{"max1", "=", "10"}], ";", 
  RowBox[{"d\[Theta]max1", "=", "0.0015"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"shadow1", "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"findShadow", "[", 
     RowBox[{
     "\[Tau]Value", ",", "ics", ",", "initial1", ",", "max1", ",", 
      "d\[Theta]max1", ",", "1", ",", "eps", ",", "0"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.64317756819293*^9, 3.643177596070825*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.605668449382744`, \
1.5708453406438407`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.64317766626047*^9, 3.6431852098558083`*^9, 
  3.6431924268125896`*^9, 3.64319338411446*^9, 3.643366058208794*^9, 
  3.643366148607386*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.605668449382744`, \
1.5708453406438407`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.64317766626047*^9, 3.6431852098558083`*^9, 
  3.6431924268125896`*^9, 3.64319338411446*^9, 3.643366058208794*^9, 
  3.643366148627655*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.605668449382744`, \
1.5708453406438407`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.64317766626047*^9, 3.6431852098558083`*^9, 
  3.6431924268125896`*^9, 3.64319338411446*^9, 3.643366058208794*^9, 
  3.6433661486460123`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.64317766626047*^9, 3.6431852098558083`*^9, 
  3.6431924268125896`*^9, 3.64319338411446*^9, 3.643366058208794*^9, 
  3.643366148666119*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"topShadow1", "=", 
   RowBox[{"shadow1", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"time1", "=", 
  RowBox[{"shadow1", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bottomShadow1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"topShadow1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"topShadow1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"topShadow1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"completeShadow1", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"topShadow1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "bottomShadow1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"ListPlot", "[", "completeShadow1", "]"}]}], "Input",
 CellChangeTimes->{{3.643177876507847*^9, 3.643177882720504*^9}}],

Cell[BoxData["258.75313199999999369538272731006145477295`8.433485528564251"], \
"Output",
 CellChangeTimes->{3.643177883219386*^9, 3.6431853885489388`*^9, 
  3.643192628102888*^9, 3.643193585652405*^9, 3.643366112983261*^9, 
  3.6433666841061363`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQAWIQPU2u9XXjvqD9DFDwI3CHXG19uj2Mv3XxorTSJUH7
k4xCDbRWKttzrApqXl+Sbg/jz+BxtuUNh8kb26tdlohTCoHJG9vnPEhsSLkR
uH/S6XqP/bW29vFSx35Eyqbbw/ircyd8kdQJhOp3tr+n8Su67HyaPYx/ftef
VeLhAft/1WXtKZnsYX9hJlOPRmaaPYz/KjHx2MJNflDzfe0N9iy62f8i1R7G
Pyfjlbg3xme/aI/XKxaTQPuamzN8ubxT7WH8ez4XV0Uv8YTaH2wfkSWbf60n
xR7G3xM2scmm3G3/uhvxZf5yYfbvHbxX1qxItofxX3YcK4jZ7AR1X4T9rEer
ROdMTbKH8UkM3/1o4bsfLXz3o4XvfrTw3Y8WvvvRwnc/WvjuRwvf/Wjhux8t
fPejhe9+tPDdjxa++9HCdz9a+O5HC9/9aOG7Hy1896OF734AEuk2nw==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageMargins->0.,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  Method->{},
  PlotRange->{{-0.0011440533399581835`, 0.002868408560752874}, {-0.0015, 
   0.0015}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.643177883219386*^9, 3.6431853885489388`*^9, 
  3.643192628102888*^9, 3.643193585652405*^9, 3.643366112983261*^9, 
  3.6433666841541357`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"d\[Phi]1", "=", 
  RowBox[{"topShadow1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"topShadow1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"d\[Phi]2", "=", 
  RowBox[{"topShadow1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"topShadow1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"const", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"initial2", "=", "0"}], ";"}], "\n", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"initial2", "/", 
      RowBox[{"(", 
       RowBox[{"initial2", "+", "const"}], ")"}]}], "*", "d\[Theta]max2"}], 
    "\[LessEqual]", "d\[Theta]max1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initial2", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"max2", "=", "100"}], ";", 
  RowBox[{"d\[Theta]max2", "=", "0.0023"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"shadow2", "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"findShadow", "[", 
     RowBox[{
     "\[Tau]Value", ",", "ics", ",", "initial2", ",", "max2", ",", 
      "d\[Theta]max2", ",", "const", ",", "eps", ",", "1"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6431778897436934`*^9, 3.643177890361823*^9}, 
   3.6431779310492153`*^9, 3.643178168420087*^9, {3.6431850495355253`*^9, 
   3.643185052802717*^9}, {3.6431851407338533`*^9, 3.643185168336722*^9}, {
   3.643188809364277*^9, 3.6431888110104094`*^9}, {3.64318895598626*^9, 
   3.643188956375898*^9}, {3.643188988056924*^9, 3.643188992692109*^9}, {
   3.643189337625908*^9, 3.643189338560278*^9}, {3.6431898611962337`*^9, 
   3.643189886501061*^9}, {3.643190116051179*^9, 3.643190116198429*^9}, {
   3.643190718997168*^9, 3.643190719596706*^9}, {3.643190899165082*^9, 
   3.643190899602955*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.0004633903303215369`"}]], "Output",
 CellChangeTimes->{
  3.6431853886285257`*^9, 3.6431888123364058`*^9, 3.64318895687316*^9, 
   3.6431889932216673`*^9, 3.643189339157999*^9, {3.643189861755188*^9, 
   3.643189887164315*^9}, 3.6431901166658897`*^9, 3.643190720004429*^9, 
   3.643190916197556*^9, 3.643192642307541*^9, 3.643192740864726*^9, {
   3.64319359052381*^9, 3.643193600949545*^9}}],

Cell[BoxData["0.0020555057127507803`"], "Output",
 CellChangeTimes->{
  3.6431853886285257`*^9, 3.6431888123364058`*^9, 3.64318895687316*^9, 
   3.6431889932216673`*^9, 3.643189339157999*^9, {3.643189861755188*^9, 
   3.643189887164315*^9}, 3.6431901166658897`*^9, 3.643190720004429*^9, 
   3.643190916197556*^9, 3.643192642307541*^9, 3.643192740864726*^9, {
   3.64319359052381*^9, 3.643193600950707*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.949905072150672`, \
1.571310507582319`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.643177890990232*^9, 3.6431779315449*^9}, 
   3.64317816894458*^9, 3.643185388731597*^9, 3.643188812452136*^9, 
   3.643188956971594*^9, 3.643188993328143*^9, 3.643189339269764*^9, {
   3.6431898618544188`*^9, 3.643189887275014*^9}, 3.643190116773905*^9, 
   3.643190720101424*^9, 3.64319091630752*^9, 3.64319264239428*^9, 
   3.643192740919759*^9, {3.6431935906324778`*^9, 3.64319360101766*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.949905072150672`, \
1.571310507582319`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.643177890990232*^9, 3.6431779315449*^9}, 
   3.64317816894458*^9, 3.643185388731597*^9, 3.643188812452136*^9, 
   3.643188956971594*^9, 3.643188993328143*^9, 3.643189339269764*^9, {
   3.6431898618544188`*^9, 3.643189887275014*^9}, 3.643190116773905*^9, 
   3.643190720101424*^9, 3.64319091630752*^9, 3.64319264239428*^9, 
   3.643192740919759*^9, {3.6431935906324778`*^9, 3.643193601035603*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.949905072150672`, \
1.571310507582319`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.643177890990232*^9, 3.6431779315449*^9}, 
   3.64317816894458*^9, 3.643185388731597*^9, 3.643188812452136*^9, 
   3.643188956971594*^9, 3.643188993328143*^9, 3.643189339269764*^9, {
   3.6431898618544188`*^9, 3.643189887275014*^9}, 3.643190116773905*^9, 
   3.643190720101424*^9, 3.64319091630752*^9, 3.64319264239428*^9, 
   3.643192740919759*^9, {3.6431935906324778`*^9, 3.643193601053694*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.643177890990232*^9, 3.6431779315449*^9}, 
   3.64317816894458*^9, 3.643185388731597*^9, 3.643188812452136*^9, 
   3.643188956971594*^9, 3.643188993328143*^9, 3.643189339269764*^9, {
   3.6431898618544188`*^9, 3.643189887275014*^9}, 3.643190116773905*^9, 
   3.643190720101424*^9, 3.64319091630752*^9, 3.64319264239428*^9, 
   3.643192740919759*^9, {3.6431935906324778`*^9, 3.643193601071944*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"topShadow2", "=", 
   RowBox[{"shadow2", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"time2", "=", 
  RowBox[{"shadow2", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bottomShadow2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"topShadow2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"topShadow2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"topShadow2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"completeShadow2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"topShadow2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "bottomShadow2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"topShadow2", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"Length", "[", 
     RowBox[{"topShadow2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "completeShadow2", "]"}]}], "Input",
 CellChangeTimes->{{3.643177984230886*^9, 3.6431779847861557`*^9}, 
   3.643184995112512*^9, {3.643189745892383*^9, 3.6431898023922167`*^9}, {
   3.64319026773604*^9, 3.643190269281597*^9}}],

Cell[BoxData["553.45653900000002067827153950929641723633`8.763683436211535"], \
"Output",
 CellChangeTimes->{
  3.64318508680774*^9, 3.643185671629513*^9, {3.643188937658094*^9, 
   3.64318894863199*^9}, 3.643189274892076*^9, 3.643189620377858*^9, {
   3.6431897553256702`*^9, 3.643189803174999*^9}, {3.643190660432308*^9, 
   3.64319066054471*^9}, 3.6431907027326813`*^9, 3.6431908643887568`*^9, 
   3.643192271316621*^9, 3.6431927345053997`*^9, 3.643192983851025*^9, 
   3.6431941989268084`*^9}],

Cell[BoxData["0.0020125`"], "Output",
 CellChangeTimes->{
  3.64318508680774*^9, 3.643185671629513*^9, {3.643188937658094*^9, 
   3.64318894863199*^9}, 3.643189274892076*^9, 3.643189620377858*^9, {
   3.6431897553256702`*^9, 3.643189803174999*^9}, {3.643190660432308*^9, 
   3.64319066054471*^9}, 3.6431907027326813`*^9, 3.6431908643887568`*^9, 
   3.643192271316621*^9, 3.6431927345053997`*^9, 3.643192983851025*^9, 
   3.6431941989288177`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxd031MzAEcx/E6qaHVjUSkFLLzUGmRmutLHTvy1HN39+vutx7WrUsnCpkU
UtGMMppyG1vWEHp+pK9VriiVKcWiGquj4WoV6R/88fv98f3ju+/e/39eTlHa
oFiBiYmJ+t/9/7rHHxtyfXbgQs1hJ4mjDC57a/TGHBa4Lm/sLx0xbsfoH3I/
X4MM0l3X57ovZoHr8TILgUi/FaVReYnXb8khKMlOVOqnAq6zxkxuSus9cOZ4
QqqnlwJOzPkW1GuUwLX0nLIsPtMNd+X9eStuVcDB1JnGOl0kcG0uaJr/sUyE
CadO39vkz0BZ+9NrrwYY4HqxLlUWM7EGLQ2KOrMaBh62OeyBlQxwfd5x/w2n
aHvsjAm3TnCIBEGYpFcSrQCuV7TuHrevFGJ+R7oU0yLBqnlfT1O5HLguLvfS
6Lqnm+zTr46t7osExkxT2WAmB67Nh7SG2XiD74dR/VTmOiVEhZ6bzzAy4DpF
nSS+pbSA5B7p93qtEpTwKNa1NoJv9rdfSihjA73njTXaKiVY5tqtnrOJ4Pvy
r6uey5esgs22LbbiKSVMxm95kpIczvdAe/zwkNEZqq8sMi92U0Fzrs07l74w
vjc8L7mkj1kPXReLRUvjVHBS/q3p9bYwvkfT9jiKDRvB1jNLN1moglqfTMlY
QSjfcUWGcu0udzjdJvLJ71CBWng7f/RXCN8t/UUHX+g8wKrL6yjMqoCd+fN5
LiSE78SfGYWB1luhJsNZ7fBvN4Opz+apHwfzfaA7rp697QXZFZUlUS4s7O0T
Mi9Mg/k+O+piXxDoA8673z/I8mbB5r48LSAgiO9PldP31vqKoeqCpuduAAtS
Y8bwVHYg31+E7xcU+++ElM4zpi8ZFhxLSyIsnhzm+9TvkfA72/zg68JlAusj
LGRVvGnMYQ7xLYtJDD82IQHQD1ZnnmFB2KAQeBTs55v4QeIHiR8kfpD4QeIH
iR8kfpD4QeIHiR8kfpD4QeIHiR8kfpD4QeIHiR8kfpD4QeIHiR8kfpD4QeIH
iR8kfpD4QeIHiR8kfpD4QeIHiR8kfpD4QeIHiR8kfpD4QeIHiR8kfpD4QeIH
iR8kfpD4QeIHiR8kfvAvFVf+og==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.00043073569656002804`, 0.002018423332038559}, {-0.0020125, 
   0.0020125}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.64318508680774*^9, 3.643185671629513*^9, {3.643188937658094*^9, 
   3.64318894863199*^9}, 3.643189274892076*^9, 3.643189620377858*^9, {
   3.6431897553256702`*^9, 3.643189803174999*^9}, {3.643190660432308*^9, 
   3.64319066054471*^9}, 3.6431907027326813`*^9, 3.6431908643887568`*^9, 
   3.643192271316621*^9, 3.6431927345053997`*^9, 3.643192983851025*^9, 
   3.6431941989975443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"time1", "+", "time2"}], ")"}], "/", "60"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Join", "[", 
   RowBox[{"completeShadow1", ",", "completeShadow2"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.643177992159012*^9, 3.6431779926816273`*^9}}],

Cell[BoxData["12.74812343333333378344226124075551827749`8.603167427864994"], \
"Output",
 CellChangeTimes->{
  3.6431781301373873`*^9, 3.6431849577267*^9, 3.643185089137052*^9, 
   3.6431856717112017`*^9, {3.643188937744768*^9, 3.643188951087069*^9}, 
   3.643189274976812*^9, 3.6431896204808397`*^9, 3.64318984338478*^9, 
   3.643190704579817*^9, {3.643190864555377*^9, 3.643190894330821*^9}, 
   3.643192271459435*^9, 3.643192986233203*^9, 3.6431942002914248`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJyV02tQVAUYxnFcuaQ5sqNIUQiChK3FJVokqOVNFmm5iCx3lsPuzi4LDIss
clGXQC4SGqQkpgy3mWowhiIEERRQXgJBTUNSQSxMnAxIp0LjouyHopk958P7
rTOzc+Y/O+cyz+7PQaUL1/BMTEw+W/78dzZnKvrnW6VoYjy+ql4+XJKA7aBp
g2D3CSmqPKLctzZtBkMezL/umARsF2V45luL2e/fhsx3B+Yq/tEA2xl/9zbt
uxiGldcKJJgvgoijWRNHBzXA9sjV7BzRC2HG68XQabYx8OdM9noxZOl1mlvh
obh0IPVC9nEJRLr9tqnRTANsT/Z9ZzPsHWK8/06w1OcW3/wwEdgeTxMeacNA
3PBJ0CNToRQeVkaIP7ipBrbLEurW144FGJ8fAX3TTouGlWpgu/+kK8NXibFl
XLF3l100TNQIu1xWqYDtLz3UYUlyX+P7xUKLk6lPx5gS2P6f+yLZF8m+SPZF
si+SfZHsi2RfJPsi2RfJvkj2RbIvkn2R7ItkXyT7ItkXyb5I9sX6lnvd5T7v
4WptmIO/fRyUeWuHZg8rge22njvND2bfQfWfMj/fmTgocN1S7r5OCWw/brXg
CYY8UaI6ln68Wgbhe2wEzX4KYLt02uSkpMsDF7LS9EKveNhr8K3q0sqBbUmR
vDW1xA23H1u6JboUD6H6hZ7z9QnAtjmv1+xeqwDT9ueeelPMQOuVC59+P84A
2+vq9XGJTzbjmpn486adDHxz2S4AXmWA7WL7kBMOalu8nhhjmWaXALxo/9v+
6nhg+5VLOx7btvONv08CrO0PGultkwHbDW1e2vob8722BRXTm0YTgDHVtneb
yoBt8/u6meepM74/TQ3NlbwmB1VUkRnDxAHbOSl7RNVyC8gekfzRpZODHL7V
uJ6L5Vr5zC8nirGC28WznbqzclhTbrPJYBXLddlihfDl9RvBxXrAWjQnh6ep
b53OyY7hevxK6uT9WUfoOPKieYObAvrLrcacR6O53trX+PFQ4hYY/qhBsCFZ
Aftkj3p/2BbN9VR+gL1o5g2wFpbWP61RwDmfEv/pqiiuk2tn2nTb3SH3ssCn
8poCUvh1lVOLkVwP3KkNHaz3gLXDXhnwXAHKhaVfDZGRXKf/VVgjtfSEzkLH
FLvl/82E/uLKlJYIrnfeSO5S1nnBoTPtjSpnJQSO8pnBFRFcH5hytq2S+oDj
jrtfl3orwapJlh8cHM71L+3zp5x8RXD2oHbki2AlSGYLJ+cOSbl+yL+7qkH8
PuRcz1txlVGCfXNjrMXpMK73P3sQ8/k2P/h99Us8y91KKD3zY89hZhfXcYnp
MZlP/AGGJjpK8pTA747neVSFcE38IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8S
P0j8IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8S
P0j8IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8SP0j8IPGDxA8S
P/gv6AoxFg==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.001079788208007805, 0.002707290649414068}, {-0.0020125, 
   0.0020125}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6431781301373873`*^9, 3.6431849577267*^9, 3.643185089137052*^9, 
   3.6431856717112017`*^9, {3.643188937744768*^9, 3.643188951087069*^9}, 
   3.643189274976812*^9, 3.6431896204808397`*^9, 3.64318984338478*^9, 
   3.643190704579817*^9, {3.643190864555377*^9, 3.643190894330821*^9}, 
   3.643192271459435*^9, 3.643192986233203*^9, 3.6431942003397493`*^9}]
}, Open  ]]
},
WindowSize->{681, 745},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 508, 8, 32, "Input"],
Cell[1068, 30, 1510, 41, 165, "Input"],
Cell[2581, 73, 1433, 34, 55, "Input"],
Cell[CellGroupData[{
Cell[4039, 111, 1166, 31, 99, "Input"],
Cell[5208, 144, 1530, 22, 32, "Output"],
Cell[6741, 168, 1529, 22, 32, "Output"],
Cell[8273, 192, 1527, 22, 32, "Output"]
}, Open  ]],
Cell[9815, 217, 802, 18, 32, "Input"],
Cell[10620, 237, 5105, 159, 241, "Input"],
Cell[15728, 398, 822, 20, 77, "Input"],
Cell[16553, 420, 1485, 37, 99, "Input"],
Cell[18041, 459, 855, 16, 99, "Input"],
Cell[18899, 477, 4182, 108, 319, "Input"],
Cell[23084, 587, 3499, 85, 319, "Input"],
Cell[26586, 674, 13611, 298, 1023, "Input"],
Cell[40200, 974, 9413, 222, 1375, "Input"],
Cell[49616, 1198, 635, 17, 99, "Input"],
Cell[50254, 1217, 2274, 58, 275, "Input"],
Cell[52531, 1277, 4648, 124, 385, "Input"],
Cell[57182, 1403, 3677, 95, 385, "Input"],
Cell[60862, 1500, 1711, 47, 275, "Input"],
Cell[CellGroupData[{
Cell[62598, 1551, 504, 13, 77, "Input"],
Cell[63105, 1566, 722, 14, 59, "Message"],
Cell[63830, 1582, 722, 14, 59, "Message"],
Cell[64555, 1598, 724, 14, 59, "Message"],
Cell[65282, 1614, 663, 13, 41, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65982, 1632, 1161, 35, 165, "Input"],
Cell[67146, 1669, 251, 4, 32, "Output"],
Cell[67400, 1675, 1573, 39, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69010, 1719, 2020, 52, 253, "Input"],
Cell[71033, 1773, 423, 7, 32, "Output"],
Cell[71459, 1782, 406, 6, 32, "Output"],
Cell[71868, 1790, 979, 17, 59, "Message"],
Cell[72850, 1809, 980, 17, 59, "Message"],
Cell[73833, 1828, 980, 17, 59, "Message"],
Cell[74816, 1847, 922, 16, 41, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75775, 1868, 1512, 44, 187, "Input"],
Cell[77290, 1914, 497, 8, 32, "Output"],
Cell[77790, 1924, 445, 7, 32, "Output"],
Cell[78238, 1933, 2396, 51, 232, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80671, 1989, 306, 8, 55, "Input"],
Cell[80980, 1999, 466, 7, 32, "Output"],
Cell[81449, 2008, 2774, 57, 232, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
