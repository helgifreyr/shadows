(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    128145,       2993]
NotebookOptionsPosition[    125040,       2899]
NotebookOutlinePosition[    125373,       2914]
CellTagsIndexPosition[    125330,       2911]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, 3.639822707820517*^9, {
   3.6430838025169783`*^9, 3.643083815386147*^9}, {3.643083848300701*^9, 
   3.643083903224534*^9}, {3.643084169201158*^9, 3.643084169416102*^9}, {
   3.6430842168645887`*^9, 3.643084305270853*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<KBHSH3.dat\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
      "Number", ",", "Number", ",", "Number", ",", "Number", ",", "Number", 
       ",", "Number", ",", "Number"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nx", "=", "251"}], ";", 
  RowBox[{"ny", "=", "30"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xmax", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"251", ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"xmin", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ymax", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"nx", "*", "ny"}], ",", "2"}], "]"}], "]"}]}], ";", 
  RowBox[{"ymin", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rh", "=", "0.04"}], ";", 
  RowBox[{"OmegaH", "=", "0.68"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822725387351*^9}, {3.639830860861123*^9, 3.639830889540786*^9}, 
   3.639831723375119*^9, {3.639839940064301*^9, 3.639839941393813*^9}, {
   3.6431923251760798`*^9, 3.6431923432165413`*^9}, {3.643194997378975*^9, 
   3.643195012619728*^9}, {3.643195582337483*^9, 3.643195599067894*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cts", " ", "=", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{"OmegaH", "==", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"x", "-", "rh"}], ")"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rh", "-", "x"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"rh", "-", 
           RowBox[{"2", "x"}]}], ")"}]}], ")"}]}]}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ct", "=", 
   RowBox[{"cts", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822725387351*^9}, {3.639830860861123*^9, 3.639830889540786*^9}, {
   3.639831723375119*^9, 3.639831761746402*^9}, {3.639831813741714*^9, 
   3.63983183547808*^9}, {3.639831891974791*^9, 3.639831899397504*^9}, {
   3.63983193066028*^9, 3.6398319311946*^9}, 3.63983292684643*^9, {
   3.639832959672049*^9, 3.6398329598109913`*^9}, {3.6398331227543907`*^9, 
   3.639833122823901*^9}, {3.639833308100128*^9, 3.639833308239058*^9}, {
   3.63983412451503*^9, 3.639834128991078*^9}, {3.639893481910615*^9, 
   3.639893485027893*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"M", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"rh", "-", 
     RowBox[{"2", "ct"}]}], ")"}], "/", "2.0"}]}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"ct", 
     RowBox[{"(", 
      RowBox[{"ct", "-", "rh"}], ")"}]}], "]"}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"rh", "-", 
       RowBox[{"2", "ct"}]}], ")"}], "/", "2"}], "/", 
    "M"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"a", "/", "M"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RH", " ", "=", " ", 
   RowBox[{"M", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"M", "^", "2"}], "-", 
      RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822725387351*^9}, {3.639830860861123*^9, 3.639830889540786*^9}, {
   3.639831723375119*^9, 3.639831726109757*^9}, {3.639831839076281*^9, 
   3.639831845690996*^9}, {3.639833607959386*^9, 3.639833609001396*^9}}],

Cell[BoxData["0.7150064068263994`"], "Output",
 CellChangeTimes->{
  3.639831841755728*^9, 3.639831933187561*^9, 3.639832258223995*^9, 
   3.6398323266620407`*^9, 3.639832361067547*^9, 3.639832430164616*^9, 
   3.639832696196529*^9, 3.6398328647288733`*^9, {3.639832965206291*^9, 
   3.6398329913868933`*^9}, 3.6398331241074057`*^9, 3.639833188368387*^9, 
   3.639833265914466*^9, {3.639833604228427*^9, 3.6398336094845257`*^9}, 
   3.63983379796813*^9, 3.639833834112484*^9, 3.639833935411751*^9, 
   3.6398339719123297`*^9, 3.6398341327754583`*^9, 3.639835163743745*^9, 
   3.6398354460947237`*^9, 3.63983683650394*^9, 3.639837692872348*^9, 
   3.6398378234593153`*^9, {3.639839931297298*^9, 3.639839952638425*^9}, 
   3.639840107470357*^9, 3.639914421762919*^9, 3.6399147517942533`*^9, 
   3.639917112101654*^9, 3.639917284507517*^9, 3.6399178505463753`*^9, 
   3.639919839445447*^9, 3.63991994822606*^9, 3.639920032564354*^9, 
   3.639921400445014*^9, 3.639921569423779*^9, 3.639921777201768*^9, 
   3.639921865233726*^9, 3.643078707596838*^9, 3.6430796539398613`*^9, 
   3.643080944103545*^9, 3.643082734567988*^9, 3.643082987932913*^9, 
   3.64308390787309*^9, 3.64308420211966*^9, 3.6430842780089808`*^9, 
   3.6430844513000183`*^9, 3.643084868868802*^9, 3.6430849466010647`*^9, 
   3.643085105487336*^9, 3.643085155334139*^9, {3.643085249237899*^9, 
   3.6430852849389753`*^9}, 3.643085323605646*^9, 3.643086198586611*^9, 
   3.643177575757725*^9, 3.6431923455878773`*^9, 3.643193306132629*^9, 
   3.64319560107924*^9, 3.643349282823203*^9, 3.643521339554158*^9, 
   3.643542603956786*^9, 3.643545083830695*^9, 3.643697004873798*^9}],

Cell[BoxData["0.714726634317484`"], "Output",
 CellChangeTimes->{
  3.639831841755728*^9, 3.639831933187561*^9, 3.639832258223995*^9, 
   3.6398323266620407`*^9, 3.639832361067547*^9, 3.639832430164616*^9, 
   3.639832696196529*^9, 3.6398328647288733`*^9, {3.639832965206291*^9, 
   3.6398329913868933`*^9}, 3.6398331241074057`*^9, 3.639833188368387*^9, 
   3.639833265914466*^9, {3.639833604228427*^9, 3.6398336094845257`*^9}, 
   3.63983379796813*^9, 3.639833834112484*^9, 3.639833935411751*^9, 
   3.6398339719123297`*^9, 3.6398341327754583`*^9, 3.639835163743745*^9, 
   3.6398354460947237`*^9, 3.63983683650394*^9, 3.639837692872348*^9, 
   3.6398378234593153`*^9, {3.639839931297298*^9, 3.639839952638425*^9}, 
   3.639840107470357*^9, 3.639914421762919*^9, 3.6399147517942533`*^9, 
   3.639917112101654*^9, 3.639917284507517*^9, 3.6399178505463753`*^9, 
   3.639919839445447*^9, 3.63991994822606*^9, 3.639920032564354*^9, 
   3.639921400445014*^9, 3.639921569423779*^9, 3.639921777201768*^9, 
   3.639921865233726*^9, 3.643078707596838*^9, 3.6430796539398613`*^9, 
   3.643080944103545*^9, 3.643082734567988*^9, 3.643082987932913*^9, 
   3.64308390787309*^9, 3.64308420211966*^9, 3.6430842780089808`*^9, 
   3.6430844513000183`*^9, 3.643084868868802*^9, 3.6430849466010647`*^9, 
   3.643085105487336*^9, 3.643085155334139*^9, {3.643085249237899*^9, 
   3.6430852849389753`*^9}, 3.643085323605646*^9, 3.643086198586611*^9, 
   3.643177575757725*^9, 3.6431923455878773`*^9, 3.643193306132629*^9, 
   3.64319560107924*^9, 3.643349282823203*^9, 3.643521339554158*^9, 
   3.643542603956786*^9, 3.643545083830695*^9, 3.643697004874482*^9}],

Cell[BoxData["0.999608713283903`"], "Output",
 CellChangeTimes->{
  3.639831841755728*^9, 3.639831933187561*^9, 3.639832258223995*^9, 
   3.6398323266620407`*^9, 3.639832361067547*^9, 3.639832430164616*^9, 
   3.639832696196529*^9, 3.6398328647288733`*^9, {3.639832965206291*^9, 
   3.6398329913868933`*^9}, 3.6398331241074057`*^9, 3.639833188368387*^9, 
   3.639833265914466*^9, {3.639833604228427*^9, 3.6398336094845257`*^9}, 
   3.63983379796813*^9, 3.639833834112484*^9, 3.639833935411751*^9, 
   3.6398339719123297`*^9, 3.6398341327754583`*^9, 3.639835163743745*^9, 
   3.6398354460947237`*^9, 3.63983683650394*^9, 3.639837692872348*^9, 
   3.6398378234593153`*^9, {3.639839931297298*^9, 3.639839952638425*^9}, 
   3.639840107470357*^9, 3.639914421762919*^9, 3.6399147517942533`*^9, 
   3.639917112101654*^9, 3.639917284507517*^9, 3.6399178505463753`*^9, 
   3.639919839445447*^9, 3.63991994822606*^9, 3.639920032564354*^9, 
   3.639921400445014*^9, 3.639921569423779*^9, 3.639921777201768*^9, 
   3.639921865233726*^9, 3.643078707596838*^9, 3.6430796539398613`*^9, 
   3.643080944103545*^9, 3.643082734567988*^9, 3.643082987932913*^9, 
   3.64308390787309*^9, 3.64308420211966*^9, 3.6430842780089808`*^9, 
   3.6430844513000183`*^9, 3.643084868868802*^9, 3.6430849466010647`*^9, 
   3.643085105487336*^9, 3.643085155334139*^9, {3.643085249237899*^9, 
   3.6430852849389753`*^9}, 3.643085323605646*^9, 3.643086198586611*^9, 
   3.643177575757725*^9, 3.6431923455878773`*^9, 3.643193306132629*^9, 
   3.64319560107924*^9, 3.643349282823203*^9, 3.643521339554158*^9, 
   3.643542603956786*^9, 3.643545083830695*^9, 3.6436970048750477`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Xtor", "[", "X_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"X", "\[NotEqual]", "1"}], ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"X", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "X"}], ")"}]}], ")"}], "^", "2"}], "]"}], ",", 
    "1000"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822726841851*^9}, {3.6398332616635113`*^9, 3.63983326225282*^9}, {
   3.639833362208622*^9, 3.6398333655501213`*^9}, {3.6398336337536488`*^9, 
   3.6398336692771997`*^9}, {3.639833930276513*^9, 3.639833930892625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "3"}], 
           "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "4"}], 
           "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "5"}], 
           "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "7"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "r_", "]"}], ":=", 
   RowBox[{"1", "-", 
    FractionBox["rh", "r"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.6398227520874777`*^9}, {3.639822831235125*^9, 3.639822831440844*^9}, 
   3.6398331788075447`*^9, {3.639834903371584*^9, 3.639834907762121*^9}, {
   3.639834943373888*^9, 3.63983495701792*^9}, {3.643193302306938*^9, 
   3.643193302418345*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"[", 
      RowBox[{"ny", ",", "All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], ",", "5"}], "]"}]}], " ", ";", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mathematica", " ", "being", " ", "silly"}], "..."}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"f1", "[", 
    RowBox[{"[", 
     RowBox[{"ny", ",", "All", ",", "2"}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.643080805224175*^9, 3.643080858584353*^9}, 
   3.643082727054243*^9, {3.643084872338292*^9, 3.643084942620863*^9}, {
   3.6430850928492517`*^9, 3.643085119343027*^9}, {3.643085262518263*^9, 
   3.643085280366884*^9}, {3.643085313620223*^9, 3.643085319129517*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"if1", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f1", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"if2", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f2", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"if0", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f0", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"iW", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"W", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822752806066*^9}, 3.639822989696681*^9, {3.639833368619607*^9, 
   3.639833369330338*^9}, {3.63983382516892*^9, 3.639833838952847*^9}, 
   3.639833962247724*^9, {3.6398376683598347`*^9, 3.639837670529829*^9}, {
   3.639837807619858*^9, 3.63983780973603*^9}, {3.643085299239916*^9, 
   3.6430853044330997`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", " ", "=", " ", "if1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", "if2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f0", "=", "if0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", "iW"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6358329670763407`*^9, 3.635832969539255*^9}, {
   3.635836172405732*^9, 3.6358361814557743`*^9}, {3.635838169502994*^9, 
   3.635838172311054*^9}, 3.636096030769092*^9, {3.639822707820517*^9, 
   3.639822752806066*^9}, {3.639822989696681*^9, 3.6398230078896217`*^9}, {
   3.639832199850816*^9, 3.639832253391707*^9}, {3.639832495022564*^9, 
   3.6398325013765917`*^9}, {3.6398327202069883`*^9, 3.6398327265897837`*^9}, 
   3.639833064026441*^9, 3.639833277388864*^9, 3.643080717732829*^9, 
   3.643080896947268*^9, 3.6430882114055977`*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"coords", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], ";"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "[", "coords", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"f0", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "*", " ", 
     RowBox[{"H", "[", "r", "]"}]}], "+", " ", 
    RowBox[{
     RowBox[{"f2", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "*", 
     RowBox[{"r", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", 
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "/", 
    RowBox[{"H", "[", "r", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]\[Theta]", "=", 
   RowBox[{
    RowBox[{"f1", "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "*", 
    RowBox[{"r", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]\[Phi]", "=", 
   RowBox[{
    RowBox[{"f2", "[", 
     RowBox[{"r", ",", "\[Theta]"}], "]"}], "*", " ", 
    RowBox[{"r", "^", "2"}], "*", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t\[Phi]", "=", 
    RowBox[{
     RowBox[{"+", 
      RowBox[{"f2", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "*", 
     RowBox[{"r", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], 
     RowBox[{"W", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tt", ",", "0", ",", "0", ",", "t\[Phi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "rr", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Theta]\[Theta]", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"t\[Phi]", ",", "0", ",", "0", ",", "\[Phi]\[Phi]"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inversemetric", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "metric", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inversemetric", " ", "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rtor", "[", "R_", "]"}], " ", ":=", " ", 
   RowBox[{"R", " ", "-", " ", 
    RowBox[{
     RowBox[{"a", "^", "2"}], "/", "RH"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.635832972239127*^9, 3.635832998932214*^9}, {
   3.63583304962444*^9, 3.635833053086396*^9}, {3.635838146327413*^9, 
   3.635838152689741*^9}, {3.6358494583669863`*^9, 3.6358494843140993`*^9}, {
   3.6361195470004463`*^9, 3.63611966162027*^9}, {3.636119706112146*^9, 
   3.636119762925138*^9}, {3.636120587524517*^9, 3.636120589186108*^9}, 
   3.636127119640697*^9, 3.636127159728249*^9, {3.636183592307225*^9, 
   3.636183602101941*^9}, {3.636183650302887*^9, 3.636183662475609*^9}, {
   3.636183727781934*^9, 3.636183728925796*^9}, {3.636186424705222*^9, 
   3.636186427316784*^9}, {3.636186558115234*^9, 3.636186623067778*^9}, {
   3.636186683801738*^9, 3.636186711083069*^9}, {3.636188372579583*^9, 
   3.636188374074327*^9}, {3.639306849434944*^9, 3.639306850348048*^9}, {
   3.6393134334714622`*^9, 3.6393134348170156`*^9}, {3.639313505886211*^9, 
   3.639313511963009*^9}, 3.639392145221756*^9, {3.639822948944982*^9, 
   3.639822987265823*^9}, {3.639823170413929*^9, 3.639823216581032*^9}, {
   3.63982325862799*^9, 3.6398232625037537`*^9}, {3.639832396700183*^9, 
   3.639832425117262*^9}, {3.639832733495761*^9, 3.6398327423146553`*^9}, {
   3.643079648849495*^9, 3.643079649114996*^9}, 3.643082636399659*^9}],

Cell[BoxData[{
 RowBox[{"christoffel", ":=", 
  RowBox[{"christoffel", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"inversemetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coords", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], "\n", 
 RowBox[{"geodesic", ":=", 
  RowBox[{"geodesic", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"christoffel", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "'"}], " ", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "'"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.635832972239127*^9, 3.635832998932214*^9}, {
   3.63583304962444*^9, 3.635833053086396*^9}, {3.635838146327413*^9, 
   3.635838152689741*^9}, {3.6358494583669863`*^9, 3.6358494843140993`*^9}, {
   3.6361195470004463`*^9, 3.63611966162027*^9}, {3.636119706112146*^9, 
   3.636119762925138*^9}, {3.636120587524517*^9, 3.636120589186108*^9}, 
   3.636127119640697*^9, 3.636127159728249*^9, {3.636183592307225*^9, 
   3.636183602101941*^9}, {3.636183650302887*^9, 3.636183662475609*^9}, {
   3.636183727781934*^9, 3.636183728925796*^9}, {3.636186424705222*^9, 
   3.636186427316784*^9}, {3.636186558115234*^9, 3.636186623067778*^9}, {
   3.636186683801738*^9, 3.636186711083069*^9}, {3.636188372579583*^9, 
   3.636188374074327*^9}, {3.639306849434944*^9, 3.639306850348048*^9}, {
   3.6393134334714622`*^9, 3.6393134348170156`*^9}, {3.639313505886211*^9, 
   3.639313511963009*^9}, {3.639392145221756*^9, 3.6393921460011053`*^9}, 
   3.639823153042695*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "solver", " ", 
     RowBox[{"function", ".", " ", "It"}], " ", "takes", " ", "in", " ", 
     "the", " ", "max", " ", "\[Tau]"}], ",", " ", 
    RowBox[{"the", " ", "initial", " ", "velocities", " ", "in", " ", "r"}], 
    ",", "\[Theta]", ",", 
    RowBox[{
    "\[Phi]", " ", "and", " ", "the", " ", "initial", " ", "coordinates", " ",
      "in", " ", "t"}], ",", "r", ",", "\[Theta]", ",", 
    RowBox[{
     RowBox[{"\[Phi]", ".", " ", "\[IndentingNewLine]", "it"}], " ", 
     "calculates", " ", "whether", " ", "the", " ", "trajectory", " ", "is", 
     " ", "timelike", " ", "or", " ", "null", " ", "from", " ", "the", " ", 
     "variable", " ", "\[Chi]", " ", "and", " ", "uinvar", " ", "which", " ", 
     "is", " ", "determined", " ", "before", " ", "\[IndentingNewLine]", 
     "calling", " ", "the", " ", "function"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"computeSoln", "[", 
     RowBox[{"max\[Tau]i_", ",", "ivsi_", ",", "icsi_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ivs", ",", "ics", ",", "i", ",", "\[Chi]", ",", "tmp", ",", "soln"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ics", "=", "icsi"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ivs", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "\[Chi]", "}"}], ",", "ivsi"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", "metric"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
            RowBox[{"ics", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"ivs", ".", 
         RowBox[{"(", 
          RowBox[{"tmp", ".", "ivs"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"\[Tau]end", " ", "=", " ", "max\[Tau]i"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Chi]slv", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"tmp", "\[Equal]", "uinvar"}], ",", "\[Chi]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ivs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"Last", "[", 
         RowBox[{"\[Chi]", "/.", "\[Chi]slv"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deq", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "''"}], "[", "\[Tau]", "]"}], 
           "\[Equal]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"geodesic", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/.", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "'"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "'"}], "[", "\[Tau]", 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"coords", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"coords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "\[Tau]", "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
              "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deq", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"deq", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"coords", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "'"}], "[", "0", "]"}], 
             "\[Equal]", 
             RowBox[{"ivs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"coords", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "0", "]"}], "\[Equal]", 
             RowBox[{"ics", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{"deq", ",", "coords", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "max\[Tau]i"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<EventLocator\>\"", ",", 
             RowBox[{"\"\<Event\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"r", "[", "\[Tau]", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"1.05", "*", "rh"}]}], ")"}]}], ",", 
             RowBox[{"\"\<EventAction\>\"", "\[RuleDelayed]", 
              RowBox[{"Throw", "[", 
               RowBox[{
                RowBox[{"\[Tau]end", "=", "\[Tau]"}], ",", 
                "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "soln"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "next", " ", "function", " ", "translates", " ", "from", 
      " ", "spherical", " ", "coordinates", " ", "to", " ", "Cartesian", " ", 
      "coordinates", " ", "to", " ", "make", " ", "plotting", " ", "simpler", 
      " ", "\[IndentingNewLine]", "I", " ", "want", " ", "to", " ", "plot", 
      " ", "in", " ", "the", " ", "R"}], ",", " ", 
     RowBox[{"i", ".", "e", ".", " ", "BL"}], ",", " ", 
     RowBox[{"radial", " ", "coordinates"}], ",", " ", 
     RowBox[{"so", " ", "for", " ", "solution", " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{
      "I", " ", "have", " ", "to", " ", "translate", " ", "to", " ", "R", " ",
        "via", " ", "r"}], " ", "=", " ", 
      RowBox[{"R", " ", "-", " ", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "/", "RH"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sphslnToCartsln", "[", "soln_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}], ",", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "\[Tau]", "]"}], "+", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "/", "RH"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]", "[", "\[Tau]", "]"}], "]"}]}], "/.", "soln"}]}], 
       " ", ";", 
       RowBox[{"ys", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "\[Tau]", "]"}], "+", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "/", "RH"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "[", "\[Tau]", "]"}], "]"}]}], "/.", "soln"}]}], 
       ";", 
       RowBox[{"zs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "\[Tau]", "]"}], "+", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "/", "RH"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "\[Tau]", "]"}], "]"}]}], "/.", 
         "soln"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"xs", ",", "ys", ",", "zs"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coordlist", "[", 
     RowBox[{"\[Tau]in_", ",", "soln_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"coords", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
       RowBox[{"{", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", "\[Tau]in", "]"}], "/.", 
           "soln"}], "//", "First"}], "]"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.635836860940906*^9, 3.635836882188463*^9}, {
   3.635838260823153*^9, 3.635838403750638*^9}, {3.635842479369845*^9, 
   3.6358425288423557`*^9}, {3.635842595846592*^9, 3.635842596731579*^9}, {
   3.635842651575425*^9, 3.6358426730910177`*^9}, {3.635843246146776*^9, 
   3.63584329469384*^9}, {3.635843493989564*^9, 3.6358434984709387`*^9}, {
   3.635843646075302*^9, 3.6358436510997458`*^9}, {3.635843769043*^9, 
   3.635843808026513*^9}, 3.635843854974348*^9, {3.6358439708134747`*^9, 
   3.6358439988014507`*^9}, {3.6358440954729156`*^9, 3.635844105881661*^9}, {
   3.635847607262068*^9, 3.63584768234691*^9}, 3.635847826815672*^9, {
   3.6358481119787903`*^9, 3.635848113543921*^9}, {3.6358487677592087`*^9, 
   3.635848790637149*^9}, {3.635848847785487*^9, 3.6358488640411177`*^9}, {
   3.635848894436006*^9, 3.635848924218313*^9}, {3.6358489570376863`*^9, 
   3.6358489654812*^9}, {3.635849006413458*^9, 3.635849007501276*^9}, {
   3.635849233710607*^9, 3.6358493599152517`*^9}, {3.635849408340809*^9, 
   3.635849451683923*^9}, {3.6358495610251207`*^9, 3.635849564841069*^9}, {
   3.635849867772031*^9, 3.635849868864263*^9}, {3.635850009287113*^9, 
   3.635850015014991*^9}, {3.635850066201453*^9, 3.635850072334169*^9}, {
   3.635850715478093*^9, 3.635850729643889*^9}, {3.635850890516655*^9, 
   3.63585089065094*^9}, {3.635850927741934*^9, 3.635850930904743*^9}, {
   3.635850964732492*^9, 3.635850979076275*^9}, {3.635851070443658*^9, 
   3.635851070552003*^9}, {3.6358549984640493`*^9, 3.635855011452649*^9}, {
   3.63585662588061*^9, 3.635856628803978*^9}, {3.6358595940958843`*^9, 
   3.635859645331695*^9}, 3.6358610806165133`*^9, {3.635861698469327*^9, 
   3.635861703544375*^9}, {3.6358620847447653`*^9, 3.635862111365858*^9}, {
   3.635862187554502*^9, 3.6358621900417213`*^9}, {3.635862670603159*^9, 
   3.635862689709435*^9}, {3.63586294103659*^9, 3.635862941128776*^9}, {
   3.635862978853428*^9, 3.6358629789702177`*^9}, {3.6359168287322493`*^9, 
   3.635916856500063*^9}, {3.6359168974062157`*^9, 3.635916899247558*^9}, {
   3.636099466635062*^9, 3.636099467080287*^9}, {3.636099593301087*^9, 
   3.636099605063566*^9}, {3.636120749806033*^9, 3.636120775873435*^9}, {
   3.6361266994289093`*^9, 3.636126738310861*^9}, {3.63612684687632*^9, 
   3.6361268476711683`*^9}, {3.636184122377878*^9, 3.6361841424402742`*^9}, {
   3.636184826017067*^9, 3.636184851027627*^9}, {3.636184905181584*^9, 
   3.6361849103730173`*^9}, {3.636184983975903*^9, 3.6361849891673*^9}, {
   3.6361850881801*^9, 3.636185090855568*^9}, {3.6361855086766453`*^9, 
   3.6361855091037416`*^9}, {3.6361858063054867`*^9, 3.636185807375502*^9}, {
   3.636185850132902*^9, 3.636185853508059*^9}, {3.6361860332718573`*^9, 
   3.636186068585531*^9}, 3.636186114012312*^9, {3.6361861642688828`*^9, 
   3.636186181496447*^9}, {3.636186377465852*^9, 3.636186388308235*^9}, {
   3.6361864844781103`*^9, 3.636186509816987*^9}, {3.636186842419696*^9, 
   3.636186858287013*^9}, {3.63618696474232*^9, 3.636186969123007*^9}, {
   3.636187002588887*^9, 3.636187033977873*^9}, {3.63618737422716*^9, 
   3.636187406294132*^9}, {3.636187462763698*^9, 3.636187463898428*^9}, {
   3.63618777332952*^9, 3.6361877735703907`*^9}, {3.6361880651573143`*^9, 
   3.636188065771721*^9}, {3.6361882616314*^9, 3.636188272392351*^9}, {
   3.639306864760098*^9, 3.639306892408499*^9}, {3.639308468232663*^9, 
   3.639308514096065*^9}, {3.639313453424519*^9, 3.639313460241234*^9}, {
   3.639313584149225*^9, 3.639313618106605*^9}, {3.639838014455957*^9, 
   3.639838014653544*^9}, 3.639916795675778*^9, {3.6399168965238457`*^9, 
   3.639916896823678*^9}, {3.6399169658865833`*^9, 3.639916966513048*^9}, {
   3.63991728138739*^9, 3.6399172824761744`*^9}, {3.63991784782952*^9, 
   3.639917848169796*^9}, {3.639919836513995*^9, 3.639919836911572*^9}, {
   3.6399199441601877`*^9, 3.639919944373478*^9}, 3.639920014020954*^9, {
   3.63992154970569*^9, 3.639921550259137*^9}, {3.63992177394466*^9, 
   3.639921774104589*^9}, {3.639921861198989*^9, 3.63992186153811*^9}, {
   3.643350239410851*^9, 3.643350241675623*^9}, {3.643351773900844*^9, 
   3.6433518074396276`*^9}, {3.6435446613343563`*^9, 3.64354466329846*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genXYPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "\[Equal]", "\[Tau]end"}], ",", 
       RowBox[{"color", "=", 
        RowBox[{"Hue", "[", "hue", "]"}]}], ",", 
       RowBox[{"color", "=", "Black"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xyz", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "Flatten"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "color"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genXZPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "\[Equal]", "\[Tau]end"}], ",", 
       RowBox[{"color", "=", 
        RowBox[{"Hue", "[", "hue", "]"}]}], ",", 
       RowBox[{"color", "=", "Black"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xyz", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "//", "Flatten"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "z"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "color"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genYZPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "\[Equal]", "\[Tau]end"}], ",", 
       RowBox[{"color", "=", 
        RowBox[{"Hue", "[", "hue", "]"}]}], ",", 
       RowBox[{"color", "=", "Black"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xyz", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"xyz", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "//", "Flatten"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "color"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genXYZPlot", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_", ",", "hue_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"computeSoln", "[", 
       RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", "soln", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "==", "\[Tau]end"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<The particle did not cross the horizon for initial \
coordinates=\>\"", ",", "icsin", ",", "\"\< and initial velocities=\>\"", ",",
          "ivsin"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<For initial coordinates=\>\"", ",", "icsin", ",", 
         "\"\< and initial velocities=\>\"", ",", "ivsin", ",", 
         "\"\< the particle crosses the horizon at \[Tau]end=\>\"", ",", 
         "\[Tau]end"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<With final coordinates=\>\"", ",", 
       RowBox[{"coordlist", "[", 
        RowBox[{"\[Tau]end", ",", "soln"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "\[Equal]", "\[Tau]end"}], ",", 
       RowBox[{"color", "=", 
        RowBox[{"Hue", "[", "hue", "]"}]}], ",", 
       RowBox[{"color", "=", "Black"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Re", "[", "xyz", "]"}], "//", "Flatten"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "0", ",", "\[Tau]end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", 
       RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "color"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.635918227700633*^9, 3.6359182471197147`*^9}, {
   3.635918436082766*^9, 3.635918551414887*^9}, {3.635919086418542*^9, 
   3.6359191408473873`*^9}, {3.635919892122779*^9, 3.635919904731124*^9}, {
   3.6359203287428293`*^9, 3.635920332777154*^9}, {3.635920982683012*^9, 
   3.635920983287322*^9}, 3.635921242254211*^9, {3.635921675108076*^9, 
   3.635921772203635*^9}, {3.636184149182275*^9, 3.636184169736897*^9}, {
   3.6361842274435377`*^9, 3.636184238926565*^9}, {3.636184892905513*^9, 
   3.636184901777832*^9}, {3.636185512213541*^9, 3.636185513238718*^9}, {
   3.636186866925673*^9, 3.63618692305689*^9}, {3.639306050196292*^9, 
   3.639306186562442*^9}, {3.639306514713902*^9, 3.639306556398106*^9}, 
   3.6393134664945602`*^9, {3.6393136154301453`*^9, 3.639313652526108*^9}, {
   3.639314754592531*^9, 3.639314762988352*^9}, {3.6435447390603113`*^9, 
   3.6435447645532312`*^9}, 3.643545308306553*^9, {3.643545750691165*^9, 
   3.6435457541720867`*^9}, {3.643547239069661*^9, 3.6435472412374496`*^9}, {
   3.643548299597392*^9, 3.643548324751191*^9}, {3.643548359704261*^9, 
   3.6435483801697273`*^9}, {3.643548415135145*^9, 3.643548422637882*^9}, {
   3.643548513759766*^9, 3.643548544814075*^9}, 3.6435486152514772`*^9, {
   3.6435487642388678`*^9, 3.643548784068924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hitOrMiss", "[", 
   RowBox[{"m\[Tau]_", ",", "icsin_", ",", "ivsin_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "xyz", "}"}], ",", 
    RowBox[{
     RowBox[{"xyz", "=", 
      RowBox[{"sphslnToCartsln", "[", 
       RowBox[{"computeSoln", "[", 
        RowBox[{"m\[Tau]", ",", "ivsin", ",", "icsin"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m\[Tau]", "\[Equal]", "\[Tau]end"}], ",", "0", ",", "1"}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.643177555931888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bisectionEdge", "[", 
   RowBox[{
   "m\[Tau]_", ",", "icsin_", ",", "d\[Theta]in_", ",", "d\[Phi]1_", ",", 
    "d\[Phi]2_", ",", "eps_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d\[Phi]One", ",", "d\[Phi]Two", ",", "k"}], "}"}], ",", 
    RowBox[{
     RowBox[{"d\[Phi]One", "=", "d\[Phi]1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Phi]Two", "=", "d\[Phi]2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"d\[Phi]Two", "-", "d\[Phi]One"}], "]"}], "/", "2"}], ">", 
        "eps"}], ",", 
       RowBox[{
        RowBox[{"resultOne", "=", 
         RowBox[{"hitOrMiss", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", 
           RowBox[{"{", 
            RowBox[{"dr", ",", "d\[Theta]in", ",", "d\[Phi]One"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"resultTwo", "=", 
         RowBox[{"hitOrMiss", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", 
           RowBox[{"{", 
            RowBox[{"dr", ",", "d\[Theta]in", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d\[Phi]Two", "+", "d\[Phi]One"}], ")"}], "/", "2"}]}],
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"resultOne", "\[Equal]", "resultTwo"}], ",", 
          RowBox[{"d\[Phi]One", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d\[Phi]Two", "+", "d\[Phi]One"}], ")"}], "/", "2"}]}], 
          ",", 
          RowBox[{"d\[Phi]Two", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d\[Phi]Two", "+", "d\[Phi]One"}], ")"}], "/", "2"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d\[Phi]One", "+", "d\[Phi]Two"}], ")"}], "/", "2"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.643177555931888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeFinder", "[", 
   RowBox[{
   "m\[Tau]_", ",", "icsin_", ",", "d\[Theta]in_", ",", "d\[Phi]1_", ",", 
    "d\[Phi]2_", ",", "num_", ",", "eps_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "shots", ",", "stepd\[Phi]", ",", "firstEdge", ",", "secondEdge"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"stepd\[Phi]", "=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"d\[Phi]1", "-", "d\[Phi]2"}], "]"}], "/", "num"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"shots", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"hitOrMiss", "[", 
           RowBox[{"\[Tau]Value", ",", "icsin", ",", 
            RowBox[{"{", 
             RowBox[{"dr", ",", "d\[Theta]in", ",", "i"}], "}"}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "d\[Phi]1", ",", "d\[Phi]2", ",", "stepd\[Phi]"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"firstEdge", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.99", "*", "d\[Phi]1"}], ",", 
        RowBox[{"1.01", "*", "d\[Phi]1"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"secondEdge", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.99", "*", "d\[Phi]2"}], ",", 
        RowBox[{"1.01", "*", "d\[Phi]2"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"shots", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "shots", "]"}]}], "}"}]}], "]"}], ">", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
              "\[Equal]", "1"}], ",", 
             RowBox[{"firstEdge", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"shots", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
              "\[Equal]", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{"secondEdge", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"shots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}]}], "]"}]}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"Length", "[", "shots", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"leftEdge", "=", 
         RowBox[{"bisectionEdge", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", "d\[Theta]in", ",", 
           RowBox[{"firstEdge", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"firstEdge", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "eps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rightEdge", "=", 
         RowBox[{"bisectionEdge", "[", 
          RowBox[{"m\[Tau]", ",", "icsin", ",", "d\[Theta]in", ",", 
           RowBox[{"secondEdge", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"secondEdge", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "eps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"leftEdge", ",", "rightEdge"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "Null"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Null"}], "}"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.643177553135079*^9}, {
  3.643215073550088*^9, 3.643215079725884*^9}, {3.643215128810959*^9, 
  3.643215156347574*^9}, {3.643215230952778*^9, 3.6432152712493153`*^9}, {
  3.64321531381634*^9, 3.643215313957511*^9}, {3.6432162173850613`*^9, 
  3.643216221473092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findShadow", "[", 
   RowBox[{
   "m\[Tau]_", ",", "icsin_", ",", "d\[Theta]List_", ",", "d\[Phi]List_", ",",
     "eps_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"leftEdge", ",", "rightEdge", ",", "edges"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"points", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]min", " ", "=", " ", 
      RowBox[{"d\[Theta]List", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]max", " ", "=", " ", 
      RowBox[{"d\[Theta]List", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]step", " ", "=", " ", 
      RowBox[{"d\[Theta]List", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Phi]1", "=", 
      RowBox[{"d\[Phi]List", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Phi]2", "=", 
      RowBox[{"d\[Phi]List", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<First d\[Theta]=\>\"", ",", "d\[Theta]min", ",", 
         "\"\<, last d\[Theta]=\>\"", ",", "d\[Theta]max", ",", 
         "\"\<, scanning from d\[Phi]=\>\"", ",", "d\[Phi]1", ",", 
         "\"\< to d\[Phi]=\>\"", ",", "d\[Phi]2"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Current d\[Theta]=\>\"", ",", "d\[Theta]"}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"edges", "=", 
         RowBox[{"edgeFinder", "[", 
          RowBox[{
          "m\[Tau]", ",", "icsin", ",", "d\[Theta]", ",", "d\[Phi]1", ",", 
           "d\[Phi]2", ",", "num", ",", "eps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"leftEdge", "=", 
         RowBox[{"edges", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rightEdge", "=", 
         RowBox[{"edges", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"num", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"i", ",", "3"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{"num", "=", 
              RowBox[{"num", "+", "1"}]}], ",", "num"}], "]"}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"leftEdge", "=!=", "Null"}], "&&", 
           RowBox[{"rightEdge", "=!=", "Null"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"d\[Phi]1", "=", "leftEdge"}], ";", "\[IndentingNewLine]", 
            RowBox[{"d\[Phi]2", "=", "rightEdge"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"leftEdge", ",", "d\[Theta]"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"rightEdge", ",", "d\[Theta]"}], "}"}]}], "]"}]}]}], 
         "]"}], ";"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{",", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{
        "d\[Theta]", ",", "d\[Theta]min", ",", "d\[Theta]max", ",", 
         "d\[Theta]step"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "points", "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643177539063092*^9, 3.64317754783072*^9}, 
   3.643196617511902*^9, {3.64321685266922*^9, 3.643216879589156*^9}, 
   3.643218224614934*^9, 3.643534900802227*^9, {3.6435349360008583`*^9, 
   3.643535049212014*^9}, {3.643535082572473*^9, 3.643535083144261*^9}, {
   3.643535121810072*^9, 3.643535122853608*^9}, {3.643535222517952*^9, 
   3.643535260342917*^9}, {3.643535311725522*^9, 3.643535328041122*^9}, {
   3.6435353750083437`*^9, 3.643535411326049*^9}, 3.6435393608385973`*^9, {
   3.643539489048699*^9, 3.6435394933292923`*^9}, {3.643539832177771*^9, 
   3.64353984325679*^9}, {3.6435402091179256`*^9, 3.64354027612076*^9}, {
   3.6435403494745703`*^9, 3.643540362818615*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Tau]end", "=."}], ";", 
  RowBox[{"uinvar", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"M", "=", "0.975"}], ";", 
  RowBox[{"a", "=", "0.85"}], ";", 
  RowBox[{"rplus", "=", 
   RowBox[{"M", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"M", "^", "2"}], "-", 
      RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ics", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "12", ",", 
     RowBox[{"\[Pi]", "/", "2"}], ",", 
     RowBox[{"\[Pi]", "/", "4"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"num", "=", "20"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"from", " ", "10", " ", "to", " ", "20", " ", 
    RowBox[{"didn", "'"}], "t", " ", "increase", " ", "computation", " ", 
    "time", " ", "much"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps", "=", "10*^-8"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Tau]Value", "=", "500"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dr", "=", 
   RowBox[{"-", "0.15"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.64317756819293*^9, 3.643177569656849*^9}, 
   3.643177974016943*^9, {3.643196182621892*^9, 3.643196186256462*^9}, {
   3.643196369833446*^9, 3.6431963708925858`*^9}, {3.6435214637282257`*^9, 
   3.643521473250853*^9}, 3.643535104131173*^9, {3.6435352391313667`*^9, 
   3.6435352397876253`*^9}, {3.6435353618507557`*^9, 3.643535367755973*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d\[Theta]min", "=", "0"}], ";", 
  RowBox[{"d\[Theta]max", "=", "0.0005"}], ";", 
  RowBox[{"d\[Theta]step", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d\[Theta]max", "-", "d\[Theta]min"}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]min", "=", 
   RowBox[{"-", "0.01"}]}], ";", 
  RowBox[{"d\[Phi]max", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shadow1", "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"findShadow", "[", 
     RowBox[{"\[Tau]Value", ",", "ics", ",", 
      RowBox[{"{", 
       RowBox[{"d\[Theta]min", ",", "d\[Theta]max", ",", "d\[Theta]step"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d\[Phi]min", ",", "d\[Phi]max"}], "}"}], ",", "eps"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.64317756819293*^9, 3.643177596070825*^9}, {
  3.643196725829555*^9, 3.6431967282509317`*^9}, {3.6435350666998243`*^9, 
  3.643535211309451*^9}, {3.643536303493968*^9, 3.643536319841186*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({3.3872987109654824`, \
1.5708042964479851`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.643535381753531*^9, 3.643535415393095*^9}, 
   3.643697103964085*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({3.3872987109654824`, \
1.5708042964479851`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.643535381753531*^9, 3.643535415393095*^9}, 
   3.643697103982786*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({3.3872987109654824`, \
1.5708042964479851`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.643535381753531*^9, 3.643535415393095*^9}, 
   3.6436971040036573`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.643535381753531*^9, 3.643535415393095*^9}, 
   3.64369710402345*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"topShadow1", "=", 
   RowBox[{"shadow1", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"time1", "=", 
  RowBox[{"shadow1", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bottomShadow1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"topShadow1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"topShadow1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"topShadow1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"completeShadow1", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"topShadow1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "bottomShadow1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"ListPlot", "[", "completeShadow1", "]"}]}], "Input",
 CellChangeTimes->{{3.643177876507847*^9, 3.643177882720504*^9}}],

Cell[BoxData["379.6496880000000260224624071270227432251`8.599982960586056"], \
"Output",
 CellChangeTimes->{
  3.643177883219386*^9, 3.6431853885489388`*^9, 3.643192628102888*^9, 
   3.643193585652405*^9, 3.6431970172616043`*^9, 3.64320930900511*^9, 
   3.643209646133301*^9, 3.643219335267358*^9, {3.643521899924075*^9, 
   3.64352190962225*^9}, 3.643536120587657*^9, 3.643697396612687*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQAWIQrWzIsUamKmA/AxTI6N9VYQvMtYfxDypsKMooDNiv
6yzz+pEZl73YOveHVS659jA+T4TllhNhMHkp+1Nl++ZLycPkpeyn5Ak1H9AK
2J9kFGqgtVLZ3ua+f+/0ezn2MH551p6SyTf8ofq17Fd/vOSb1JBjD+Pbbfv8
94qF//4/K0ESBvZPls4+osCQYw/jeyQJRFiW+EHNN7ZvmurcnROebQ/jr5n7
fvmxbt/9x3ft6GX7YGavAvTOxNosexg/J2Pi25p6H6j9VvYLgMq90zPtYfyO
Q181Yvy9908+Xe+xv9bWXgjkX7YMexifeY1MVMpvT6j7HOyjgNJlfmn2MD6J
4bsfLXz3o4XvfrTw3Y8WvvvRwnc/WvjuRwvf/Wjhux8tfPejhe9+tPDdjxa+
+9HCdz9a+O5HC9/9aOG7Hy1896OF73608N0PAN1ZNcE=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.0010056762695312492`, 0.0035786743164062506`}, {-0.0005, 
   0.0005}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.643177883219386*^9, 3.6431853885489388`*^9, 3.643192628102888*^9, 
   3.643193585652405*^9, 3.6431970172616043`*^9, 3.64320930900511*^9, 
   3.643209646133301*^9, 3.643219335267358*^9, {3.643521899924075*^9, 
   3.64352190962225*^9}, 3.643536120587657*^9, 3.64369739687885*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d\[Phi]min", "=", 
   RowBox[{"topShadow1", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"topShadow1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[Phi]max", "=", 
    RowBox[{"topShadow1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"topShadow1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"const", "=", "10"}], ";", "\n", 
    RowBox[{"initial2", "=", "0"}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"initial2", "/", 
           RowBox[{"(", 
            RowBox[{"initial2", "+", "const"}], ")"}]}], "*", 
          "d\[Theta]max2"}], "\[LessEqual]", "d\[Theta]max1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"initial2", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], "\n", "max2"}], "=", 
     RowBox[{"initial2", "+", "100"}]}], ";", 
    RowBox[{"d\[Theta]max2", "=", "0.002"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Theta]min", "=", 
   RowBox[{"topShadow1", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
  RowBox[{"d\[Theta]max", "=", "0.002"}], ";", 
  RowBox[{"d\[Theta]step", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d\[Theta]max", "-", "d\[Theta]min"}], ")"}], "/", "100"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shadow2", "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"findShadow", "[", 
     RowBox[{"\[Tau]Value", ",", "ics", ",", 
      RowBox[{"{", 
       RowBox[{"d\[Theta]min", ",", "d\[Theta]max", ",", "d\[Theta]step"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d\[Phi]min", ",", "d\[Phi]max"}], "}"}], ",", "eps"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6431778897436934`*^9, 3.643177890361823*^9}, 
   3.6431779310492153`*^9, 3.643178168420087*^9, {3.6431850495355253`*^9, 
   3.643185052802717*^9}, {3.6431851407338533`*^9, 3.643185168336722*^9}, {
   3.643188809364277*^9, 3.6431888110104094`*^9}, {3.64318895598626*^9, 
   3.643188956375898*^9}, {3.643188988056924*^9, 3.643188992692109*^9}, {
   3.643189337625908*^9, 3.643189338560278*^9}, {3.6431898611962337`*^9, 
   3.643189886501061*^9}, {3.643190116051179*^9, 3.643190116198429*^9}, {
   3.643190718997168*^9, 3.643190719596706*^9}, {3.643190899165082*^9, 
   3.643190899602955*^9}, {3.64319704611653*^9, 3.643197046349516*^9}, 
   3.643198659954768*^9, 3.643209373178735*^9, {3.643209920712384*^9, 
   3.643209921920562*^9}, {3.643212298158856*^9, 3.643212304949389*^9}, 
   3.643214494469439*^9, {3.643250816855174*^9, 3.643250817096439*^9}, {
   3.643525768368778*^9, 3.6435257695124683`*^9}, {3.643536132503118*^9, 
   3.6435362980381193`*^9}, 3.643538394462825*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.963802665694661`, \
1.5709173212813838`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.6435362987487392`*^9, 3.643536323666224*^9}, 
   3.643697397056986*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.963802665694661`, \
1.5709173212813838`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.6435362987487392`*^9, 3.643536323666224*^9}, 
   3.643697397076179*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.963802665694661`, \
1.5709173212813838`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.6435362987487392`*^9, 3.643536323666224*^9}, 
   3.643697397093829*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6435362987487392`*^9, 3.643536323666224*^9}, 
   3.6436973971120653`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"topShadow2", "=", 
   RowBox[{"shadow2", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"time2", "=", 
  RowBox[{"shadow2", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bottomShadow2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"topShadow2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"topShadow2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"topShadow2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"completeShadow2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"topShadow2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "bottomShadow2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"topShadow2", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"Length", "[", 
     RowBox[{"topShadow2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"completeShadow2", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.643177984230886*^9, 3.6431779847861557`*^9}, 
   3.643184995112512*^9, {3.643189745892383*^9, 3.6431898023922167`*^9}, {
   3.64319026773604*^9, 3.643190269281597*^9}, {3.643524300181705*^9, 
   3.6435243025051613`*^9}, {3.643524533745974*^9, 3.643524573789927*^9}}],

Cell[BoxData["2700.01866100000006554182618856430053710938`9.451966679046508"],\
 "Output",
 CellChangeTimes->{
  3.64318508680774*^9, 3.643185671629513*^9, {3.643188937658094*^9, 
   3.64318894863199*^9}, 3.643189274892076*^9, 3.643189620377858*^9, {
   3.6431897553256702`*^9, 3.643189803174999*^9}, {3.643190660432308*^9, 
   3.64319066054471*^9}, 3.6431907027326813`*^9, 3.6431908643887568`*^9, 
   3.643192271316621*^9, 3.6431927345053997`*^9, 3.643192983851025*^9, 
   3.6431941989268084`*^9, 3.643198791157366*^9, 3.643209314585314*^9, 
   3.6432122013128977`*^9, 3.643214405321254*^9, {3.643218155608736*^9, 
   3.643218177155703*^9}, 3.6432207797278976`*^9, 3.643252342945052*^9, 
   3.643524272165143*^9, 3.643524302907104*^9, {3.643524539557355*^9, 
   3.6435245744111147`*^9}, 3.643526678867548*^9, 3.643538398230084*^9, 
   3.6437000970535727`*^9}],

Cell[BoxData["0.001985`"], "Output",
 CellChangeTimes->{
  3.64318508680774*^9, 3.643185671629513*^9, {3.643188937658094*^9, 
   3.64318894863199*^9}, 3.643189274892076*^9, 3.643189620377858*^9, {
   3.6431897553256702`*^9, 3.643189803174999*^9}, {3.643190660432308*^9, 
   3.64319066054471*^9}, 3.6431907027326813`*^9, 3.6431908643887568`*^9, 
   3.643192271316621*^9, 3.6431927345053997`*^9, 3.643192983851025*^9, 
   3.6431941989268084`*^9, 3.643198791157366*^9, 3.643209314585314*^9, 
   3.6432122013128977`*^9, 3.643214405321254*^9, {3.643218155608736*^9, 
   3.643218177155703*^9}, 3.6432207797278976`*^9, 3.643252342945052*^9, 
   3.643524272165143*^9, 3.643524302907104*^9, {3.643524539557355*^9, 
   3.6435245744111147`*^9}, 3.643526678867548*^9, 3.643538398230084*^9, 
   3.643700097076024*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011111111111111112`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
mD/A/AHmDzB/gPkDzB9g/sD/AORslk4=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.0007929696607589715, 0.002723014608621598}, {-0.001985, 
   0.001985}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.64318508680774*^9, 3.643185671629513*^9, {3.643188937658094*^9, 
   3.64318894863199*^9}, 3.643189274892076*^9, 3.643189620377858*^9, {
   3.6431897553256702`*^9, 3.643189803174999*^9}, {3.643190660432308*^9, 
   3.64319066054471*^9}, 3.6431907027326813`*^9, 3.6431908643887568`*^9, 
   3.643192271316621*^9, 3.6431927345053997`*^9, 3.643192983851025*^9, 
   3.6431941989268084`*^9, 3.643198791157366*^9, 3.643209314585314*^9, 
   3.6432122013128977`*^9, 3.643214405321254*^9, {3.643218155608736*^9, 
   3.643218177155703*^9}, 3.6432207797278976`*^9, 3.643252342945052*^9, 
   3.643524272165143*^9, 3.643524302907104*^9, {3.643524539557355*^9, 
   3.6435245744111147`*^9}, 3.643526678867548*^9, 3.643538398230084*^9, 
   3.643700097114544*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d\[Phi]min", "=", "0.0005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]max", "=", "0.003"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d\[Theta]min", "=", "0.0041"}], ";", 
  RowBox[{"d\[Theta]max", "=", "0.0044"}], ";", 
  RowBox[{"d\[Theta]step", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d\[Theta]max", "-", "d\[Theta]min"}], ")"}], "/", "50"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shadow3", "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"findShadow", "[", 
     RowBox[{"\[Tau]Value", ",", "ics", ",", 
      RowBox[{"{", 
       RowBox[{"d\[Theta]min", ",", "d\[Theta]max", ",", "d\[Theta]step"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d\[Phi]min", ",", "d\[Phi]max"}], "}"}], ",", "eps"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.643525431669077*^9, 3.643525476942849*^9}, {
   3.6435255311284657`*^9, 3.643525558175664*^9}, {3.64352559075181*^9, 
   3.643525614104751*^9}, {3.64352576155724*^9, 3.643525785128834*^9}, {
   3.64352582301682*^9, 3.643525823158608*^9}, {3.6435258676232777`*^9, 
   3.643525934792904*^9}, 3.643526629794492*^9, {3.6435266922883167`*^9, 
   3.643526692788362*^9}, {3.643529794292204*^9, 3.643529800769754*^9}, {
   3.643529962361383*^9, 3.643529971994544*^9}, 3.643530472582752*^9, {
   3.643530514627181*^9, 3.6435305149758244`*^9}, {3.6435305821355553`*^9, 
   3.643530610754384*^9}, {3.643530897768107*^9, 3.6435309163168783`*^9}, {
   3.643538419604001*^9, 3.643538460911674*^9}, 3.643538604002118*^9, {
   3.643538752217911*^9, 3.643538753299148*^9}, 3.643538987248362*^9, 
   3.643539874826579*^9, {3.643540300684795*^9, 3.643540301611751*^9}, {
   3.6435403354213037`*^9, 3.6435403356149597`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.99953162973988`, \
1.5708091293989488`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.643542803279193*^9, 3.643700129050267*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.99953162973988`, \
1.5708091293989488`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.643542803279193*^9, 3.643700129069025*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Input value \[NoBreak]\\!\\({11.99953162973988`, \
1.5708091293989488`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.643542803279193*^9, 3.6437001290882397`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.643542803279193*^9, 3.643700129108224*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"topShadow3", "=", 
   RowBox[{"shadow3", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"time3", "=", 
  RowBox[{"shadow3", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"bottomShadow3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"topShadow3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"topShadow3", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"topShadow3", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"completeShadow3", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"topShadow3", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "bottomShadow3"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"topShadow3", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"Length", "[", 
     RowBox[{"topShadow3", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"topShadow3", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.643525828527609*^9, 3.6435258515460443`*^9}, {
   3.64352667473964*^9, 3.6435266748532457`*^9}, 3.643538992832781*^9, 
   3.6435403711146*^9, {3.643542758148861*^9, 3.64354276006546*^9}}],

Cell[BoxData["1493.95492199999989679781720042228698730469`9.194937406728208"],\
 "Output",
 CellChangeTimes->{
  3.643525851790621*^9, 3.643526633136579*^9, 3.643526681495925*^9, 
   3.64352937230343*^9, 3.6435295166041393`*^9, {3.643530507155209*^9, 
   3.643530532836349*^9}, 3.643538563737422*^9, {3.643538975019561*^9, 
   3.643538993228332*^9}, 3.643540287195285*^9, 3.643542019437334*^9, 
   3.6435443191249037`*^9, 3.643701622985125*^9}],

Cell[BoxData["0.004328`"], "Output",
 CellChangeTimes->{
  3.643525851790621*^9, 3.643526633136579*^9, 3.643526681495925*^9, 
   3.64352937230343*^9, 3.6435295166041393`*^9, {3.643530507155209*^9, 
   3.643530532836349*^9}, 3.643538563737422*^9, {3.643538975019561*^9, 
   3.643538993228332*^9}, 3.643540287195285*^9, 3.643542019437334*^9, 
   3.6435443191249037`*^9, 3.643701623000474*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.016666666666666666`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw90w9MlGUcB3B2MRF0xLCcnoiQTsGzzsm0Px58EyUg8u445OTP/Xnft9Sb
6fE+GtSU+JMDbTiJqJ1SwIS100pzHrJTy8T5B/8tEo1YYistUoYEhNd0rJ7n
YL93e/fus73v+/ye3+/7xCtFlg2akJAQI7/Fs3og2x87JiF8TpMj8aqKF443
DnlLFLISlfdy234Jqc4dT7b/qKIoetfZK0whf3RuLMEGCTtbrfvP9Kj4uVVN
jtikkDtLzjRrf3CirX/Z8vA7Kj4/H3dsW55C3uaqGyyd58Sg7ukbOfdUNA15
L2alK2SNbvfMXrcDC9UBd9MDFXcWTKn8NEkhr5L+6HrutB3OtkvT7v+torh+
Vqg1ViEvnfp1TEGoHQf+bT2UFJj8f5hC9o+O33wv04Ybhoq0snEV86p4Qx7K
5GC9ewoxrdL2e+dTDN83a/V9N2VysB8dBVhz4aXyGREMZVjuOHVSJj8u2/zt
O6P5eD/82RhHFEP8Mb7jRpmcEtHTqs7NR/vaYf+hmQz3vvjsfFyFTA7Wk5KH
obrruaMxDHu39D85LMtkvvrBNOt6JPx0eCR5PsPsUGvk86kyma9eP+stK2Rt
de2eRIYLfDuueJkslk/enIsGh7KkW8/Avz7e+J9E9vE4XHx7HbpbUi7PXcFw
/Rq/bkvk4PyLcjC9X7vRZWATefFL5FfaeALKLXhNF9D4Uhn6xPzqJXLGbzue
OerNRnlRd/N4BsO7PC76rRLZ4o+tGhg2w+/7xpBhYhBxQZpEnqPnf5TNGA7U
9H6cy/Aqb39mjEROtNWeG/vLhMUGV0lf4eT6d53kWlG/yYQ3K9bMSFAY+NfT
NTVOsohT5KBxIgeuyff1TnJaOw+Q34hbU8ff+M7NcFfMr8tBFser6isjItf2
3g8rZhDtu7bFQdaK+juMSK87UW3ZySC23xfqIAfn+8iIilt18xsrGcQ4sjx2
sihXl27Cydnus/27GQI5vIIFdvKjBN6AEyaM2F+3L9s3Oe8vbeR9Hnf0rjgz
lrQsfFz6CUOmmMciG1mUV1lsxoY/NZ5LDQwPS3nAGwrJIs6Dt81oWvxrUvRB
hs6sFz9cFVJIFsfzl/xs9LhPd9m8DB18O+05BeQW0cB/shHl82z1HmHg01ld
szefPHG+LMgMbI8Y8bGJ8+vJI0fxuA6FrcMHK81ewykGMd7VuvXk/wGAfjZq

     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.0009153823852539062, 0.004088600000000001},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageMargins->0.,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  Method->{},
  PlotRange->{{0.0009359741210937499, 0.0022538452148437504`}, {0.0041, 
   0.004328}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.643525851790621*^9, 3.643526633136579*^9, 3.643526681495925*^9, 
   3.64352937230343*^9, 3.6435295166041393`*^9, {3.643530507155209*^9, 
   3.643530532836349*^9}, 3.643538563737422*^9, {3.643538975019561*^9, 
   3.643538993228332*^9}, 3.643540287195285*^9, 3.643542019437334*^9, 
   3.6435443191249037`*^9, 3.6437016230360613`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"time1", "+", "time2", "+", "time3"}], ")"}], "/", "60"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
    "completeShadow1", ",", "completeShadow2", ",", "completeShadow3"}], 
    "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.0012"}], ",", "0.0038"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.643177992159012*^9, 3.6431779926816273`*^9}, {
  3.643214740106021*^9, 3.6432147459800863`*^9}, {3.6432168250709543`*^9, 
  3.6432168280721397`*^9}, {3.643250721141725*^9, 3.643250805403799*^9}, {
  3.643252350544208*^9, 3.643252352887681*^9}, {3.64352663789423*^9, 
  3.643526653665012*^9}}],

Cell[BoxData["76.22705451666666647270176326856017112732`9.203739047500562"], \
"Output",
 CellChangeTimes->{
  3.6431781301373873`*^9, 3.6431849577267*^9, 3.643185089137052*^9, 
   3.6431856717112017`*^9, {3.643188937744768*^9, 3.643188951087069*^9}, 
   3.643189274976812*^9, 3.6431896204808397`*^9, 3.64318984338478*^9, 
   3.643190704579817*^9, {3.643190864555377*^9, 3.643190894330821*^9}, 
   3.643192271459435*^9, 3.643192986233203*^9, 3.6431942002914248`*^9, 
   3.643198791284169*^9, 3.643212205318075*^9, 3.643214422522799*^9, 
   3.64321612652499*^9, 3.6432167832001467`*^9, 3.643216828399988*^9, 
   3.643218180862734*^9, 3.6432207799015837`*^9, {3.643250739800314*^9, 
   3.6432507441226473`*^9}, {3.643250781995762*^9, 3.643250805702999*^9}, {
   3.6432523469551888`*^9, 3.64325235319564*^9}, 3.643524276043741*^9, 
   3.6435245774891663`*^9, {3.6435266464076767`*^9, 3.643526683659512*^9}, 
   3.643529519415415*^9, 3.64353897786633*^9, 3.6435402899453*^9, 
   3.6435420196069202`*^9, 3.643701623127267*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
+Q3Mb2B+A/MbmN/A/AbmN/wXnM1Z6Q==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.0012, 0.0038}, {-0.005, 0.005}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6431781301373873`*^9, 3.6431849577267*^9, 3.643185089137052*^9, 
   3.6431856717112017`*^9, {3.643188937744768*^9, 3.643188951087069*^9}, 
   3.643189274976812*^9, 3.6431896204808397`*^9, 3.64318984338478*^9, 
   3.643190704579817*^9, {3.643190864555377*^9, 3.643190894330821*^9}, 
   3.643192271459435*^9, 3.643192986233203*^9, 3.6431942002914248`*^9, 
   3.643198791284169*^9, 3.643212205318075*^9, 3.643214422522799*^9, 
   3.64321612652499*^9, 3.6432167832001467`*^9, 3.643216828399988*^9, 
   3.643218180862734*^9, 3.6432207799015837`*^9, {3.643250739800314*^9, 
   3.6432507441226473`*^9}, {3.643250781995762*^9, 3.643250805702999*^9}, {
   3.6432523469551888`*^9, 3.64325235319564*^9}, 3.643524276043741*^9, 
   3.6435245774891663`*^9, {3.6435266464076767`*^9, 3.643526683659512*^9}, 
   3.643529519415415*^9, 3.64353897786633*^9, 3.6435402899453*^9, 
   3.6435420196069202`*^9, 3.643701623232328*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.0001", "+", 
      RowBox[{"i", "*", "0.00001"}]}], ",", 
     RowBox[{"0.0035", "+", 
      RowBox[{"j", "*", "0.0001"}]}], ",", 
     RowBox[{"hitOrMiss", "[", 
      RowBox[{"\[Tau]Value", ",", "ics", ",", 
       RowBox[{"{", 
        RowBox[{"dr", ",", 
         RowBox[{"0.0035", "+", 
          RowBox[{"j", "*", "0.0001"}]}], ",", 
         RowBox[{"0.0001", "+", 
          RowBox[{"i", "*", "0.00001"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.643214461417437*^9, 3.643214462084949*^9}, {
   3.64321450078024*^9, 3.643214503078272*^9}, {3.643218255196928*^9, 
   3.643218305023411*^9}, {3.643218337885036*^9, 3.643218360203586*^9}, {
   3.643218413744637*^9, 3.6432184360624857`*^9}, {3.643218491991478*^9, 
   3.6432185019256907`*^9}, {3.643218648529634*^9, 3.643218674875154*^9}, {
   3.643218809548349*^9, 3.643218810923566*^9}, {3.643218842297462*^9, 
   3.6432188643531857`*^9}, {3.64321902880927*^9, 3.64321902899277*^9}, 
   3.643521367853898*^9, 3.6435214812094393`*^9, {3.6435215672407007`*^9, 
   3.643521585033245*^9}, {3.6435216205953093`*^9, 3.643521622925194*^9}, {
   3.643521925291525*^9, 3.643521958942832*^9}, {3.643521996316052*^9, 
   3.643522001465776*^9}, {3.6435246636760597`*^9, 3.6435246641512403`*^9}, {
   3.643524763342222*^9, 3.643524763446746*^9}, {3.64352481796493*^9, 
   3.643524824890324*^9}, {3.6435249496847878`*^9, 3.643524970323551*^9}, {
   3.643525051186851*^9, 3.643525051419077*^9}, {3.6435250834485292`*^9, 
   3.643525083854122*^9}, {3.643525148655455*^9, 3.643525159118909*^9}, {
   3.6435252778169003`*^9, 3.643525385313908*^9}, {3.643529565644827*^9, 
   3.643529569929801*^9}, {3.643529600576239*^9, 3.643529600790585*^9}, {
   3.6435296946046543`*^9, 3.643529697239594*^9}, {3.643529867216791*^9, 
   3.643529945062697*^9}, {3.643539146658944*^9, 3.643539191097865*^9}, {
   3.643539332090625*^9, 3.643539332188512*^9}, {3.6435394044618073`*^9, 
   3.6435394382215033`*^9}, {3.643539507740942*^9, 3.64353952297618*^9}, {
   3.6435395839344273`*^9, 3.643539692356654*^9}, {3.643539722876021*^9, 
   3.643539742334065*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], ":", 
  " ", "\<\"Input value \[NoBreak]\\!\\({11.999525891586561`, \
1.5708077058270695`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.643521544340085*^9, 3.6435215856318417`*^9, 3.643522002778017*^9, 
   3.6435246677664337`*^9, 3.643524763867158*^9, 3.643524825372057*^9, {
   3.643524950854445*^9, 3.643524971778303*^9}, 3.643525051841043*^9, 
   3.643525084298368*^9, 3.643525161564575*^9, {3.6435253341047783`*^9, 
   3.643525385756592*^9}, {3.643529551120249*^9, 3.6435295704557247`*^9}, 
   3.643529601731474*^9, 3.643529697681024*^9, {3.6435298676466703`*^9, 
   3.643529945678609*^9}, {3.6435391476442213`*^9, 3.643539191585944*^9}, 
   3.643539332621008*^9, {3.643539431436926*^9, 3.643539438739399*^9}, {
   3.643539595121717*^9, 3.643539646442513*^9}, 3.643539692814727*^9, 
   3.643539742995874*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], ":", 
  " ", "\<\"Input value \[NoBreak]\\!\\({11.999525891586561`, \
1.5708077058270695`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.643521544340085*^9, 3.6435215856318417`*^9, 3.643522002778017*^9, 
   3.6435246677664337`*^9, 3.643524763867158*^9, 3.643524825372057*^9, {
   3.643524950854445*^9, 3.643524971778303*^9}, 3.643525051841043*^9, 
   3.643525084298368*^9, 3.643525161564575*^9, {3.6435253341047783`*^9, 
   3.643525385756592*^9}, {3.643529551120249*^9, 3.6435295704557247`*^9}, 
   3.643529601731474*^9, 3.643529697681024*^9, {3.6435298676466703`*^9, 
   3.643529945678609*^9}, {3.6435391476442213`*^9, 3.643539191585944*^9}, 
   3.643539332621008*^9, {3.643539431436926*^9, 3.643539438739399*^9}, {
   3.643539595121717*^9, 3.643539646442513*^9}, 3.643539692814727*^9, 
   3.6435397430142803`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "MessageName"], ":", 
  " ", "\<\"Input value \[NoBreak]\\!\\({11.999525891586561`, \
1.5708077058270695`}\\)\[NoBreak] lies outside the range of data in the \
interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.643521544340085*^9, 3.6435215856318417`*^9, 3.643522002778017*^9, 
   3.6435246677664337`*^9, 3.643524763867158*^9, 3.643524825372057*^9, {
   3.643524950854445*^9, 3.643524971778303*^9}, 3.643525051841043*^9, 
   3.643525084298368*^9, 3.643525161564575*^9, {3.6435253341047783`*^9, 
   3.643525385756592*^9}, {3.643529551120249*^9, 3.6435295704557247`*^9}, 
   3.643529601731474*^9, 3.643529697681024*^9, {3.6435298676466703`*^9, 
   3.643529945678609*^9}, {3.6435391476442213`*^9, 3.643539191585944*^9}, 
   3.643539332621008*^9, {3.643539431436926*^9, 3.643539438739399*^9}, {
   3.643539595121717*^9, 3.643539646442513*^9}, 3.643539692814727*^9, 
   3.643539743032786*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(InterpolatingFunction :: dmval\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.643521544340085*^9, 3.6435215856318417`*^9, 3.643522002778017*^9, 
   3.6435246677664337`*^9, 3.643524763867158*^9, 3.643524825372057*^9, {
   3.643524950854445*^9, 3.643524971778303*^9}, 3.643525051841043*^9, 
   3.643525084298368*^9, 3.643525161564575*^9, {3.6435253341047783`*^9, 
   3.643525385756592*^9}, {3.643529551120249*^9, 3.6435295704557247`*^9}, 
   3.643529601731474*^9, 3.643529697681024*^9, {3.6435298676466703`*^9, 
   3.643529945678609*^9}, {3.6435391476442213`*^9, 3.643539191585944*^9}, 
   3.643539332621008*^9, {3.643539431436926*^9, 3.643539438739399*^9}, {
   3.643539595121717*^9, 3.643539646442513*^9}, 3.643539692814727*^9, 
   3.6435397430523577`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.64352156339282*^9, 3.643521600628368*^9, 3.643522562248735*^9, 
   3.6435246851825657`*^9, 3.643524782127891*^9, 3.643524844213464*^9, 
   3.643524968561899*^9, 3.643525031507388*^9, 3.643525070611857*^9, 
   3.643525140172475*^9, 3.643525189528203*^9, {3.643525340077132*^9, 
   3.6435253882164793`*^9}, {3.6435295535614967`*^9, 3.643529580274797*^9}, 
   3.643529611477334*^9, 3.643529704861911*^9, {3.6435298775617523`*^9, 
   3.64352995161306*^9}, {3.643539156099218*^9, 3.6435392040414352`*^9}, 
   3.643539347756809*^9, {3.643539433064549*^9, 3.643539445439796*^9}, {
   3.643539611525941*^9, 3.643539650362365*^9}, 3.6435397023231792`*^9, 
   3.643539846445961*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"shadow", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "completeShadow1", ",", "completeShadow2", ",", "completeShadow3"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"obsShadow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "shadow", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"xObs", "=", 
     RowBox[{
      RowBox[{"shadow", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"\[Phi]\[Phi]", "/.", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"ics", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "/.", 
        RowBox[{"\[Theta]", "\[Rule]", 
         RowBox[{"ics", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"yObs", "=", 
     RowBox[{
      RowBox[{"shadow", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"\[Theta]\[Theta]", "/.", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"ics", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "/.", 
        RowBox[{"\[Theta]", "\[Rule]", 
         RowBox[{"ics", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zObs", "=", 
     RowBox[{
      RowBox[{"-", "dr"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"rr", "/.", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"ics", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "/.", 
        RowBox[{"\[Theta]", "\[Rule]", 
         RowBox[{"ics", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Alpha]", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"xObs", "^", "2"}], "+", 
         RowBox[{"yObs", "^", "2"}]}], "]"}], "/", "zObs"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Beta]", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"yObs", "/", "xObs"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"obsShadow", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"xObs", ",", "yObs"}], "}"}]}], ";"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "shadow", "]"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"obsShadow", ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.643521398917521*^9, 3.643521399299157*^9}, {
  3.643529535781913*^9, 3.6435295373453417`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
FUCmQ+tp5kQr8Iqy8k68LuTb6EnJmP2RSqDis7ohLtYKjqfeDhr9RMj3oaIg
o4v9yiA8U/9lwjEr8BP6D7pfL+S74NlQnYlJqmAk66tic88KzoYEXHf7KOTb
SyNzhqqTAERB1016WqzA/+27fN0OId8WrzoPlb9UB8dcC5cSoTX0KriYydQJ
+Sb+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDiDyT+QOIPJP5A4g8k/kDi
DyT+QOIPXBy6Q6P8jTX4/uf1gDscvaW8LzvPlm/vllfJ0lHWMOFRdHBlgTs8
KShuvnLdlu9cj+l/fZaxBr8LAQeOFrtD8B64ufycLd/vFzc5lO63gkk7PR6H
lLnDt4yNd+IO2vJtlRZ79KzjDzctNpa3feEOX1IzDs7YZMt3+ACp9Nd5Ipji
3Te8+bU7TArNBO0wW77fV67wF08QQYB9zbJL79yhYXzy/rcTbfk+nVF+PaPa
EqYr3jm77KM7DJdZ2LDF3Zbv7BbjmbvDLGFm48naId3u8KDcod5Tz5ZvuyW/
BGV3WUDgvQT9XikxKOm//H3RZxu+t65yXzUtzgL++3pJDJ/vrTbse2bDd8vR
7gOJn81h9qZxmzdp/nj8YA0l3z9t+G58YXuxq80MQkIdb481EMM/guQg1d02
fIsW1vmdqjKFUE+1TlULMVzLUizfvNCG7yJZUdZUiQnMtWhzKLUTw92+yLA8
Txu+n118c1Y9xRjmfS8JTnERw4aCokUhhjZ8978DU79gI1hQfeXAtKFimDta
uK3ggzXf5WtCTjTaGsLCvH2PTUAMkVsm/F1baM33rNSjddLt+rA4LVr+9Rgx
2Ivjw8MOWvOtNned/uv7erBkdcCITF8xKJ484nZ1sTXffqbJ4QUSXYj4z+tJ
MRyIPxe8YLg13ye6grXrq3VgqYfxOecgMQStyOSGqljzfUhdMGLJAB2IMuir
/ThPDH847htR+NyK7wnFe2JuZ2nD8i/V+n8tEcOyvvDm8FNWfIevu1hmPU4b
VlTk+8ZFi2HmUZe9teFWfO+wHVR6WFUbYnJObubWiGHNjOqGSHcrvv30a9ZG
tQghNiXhtsxmMYTWRw8u7hbxPa5l22Pux//bquXzO//eJYbk5o78Y7dFfOea
6XyPbxdC3KRxjjtTfvz+JpMq0uJFfNc8Ds8fq6UN8YMcQyakiWFz5S5ZKw8R
33IrV04yHKUN/329LYayqCypjR2WfMsF/pbqvlUb1n14//j5eTE4T94ttj1t
yXd75QODr1XasPFxiXzaVTFYOns2S6Za8n1ysF5e1mgd2HTxyojgWz/us+TS
lhvfLfg+N9BPpHxPBzbv2rfc+q4YZMruO5aesOA7Ze/JprdBurAlLPpcU7EY
vjeEtSUOseDbUnn1+l5TPdj2e8DrC2ViKB117+TDWHO+41dX7PjFSB+2O3gY
RL0Qw0T7IIXb3mZ8e7/zH9923gB2KhlPEL8Rg9SQT3WztpvwTfYNyb4h2Tck
+4Zk35DsG5J9Q7JvSPYNyb4h2Tck+4Zk35DsG5J9Q7JvSPYNyb4h2Tck+4Zk
35DsG5J9Q7JvSPYNyb4h2Tck+4Zk35DsG5J9Q7JvSPYNyb4h2Tck+4Zk35Ds
G5J9Q7JvSPYNyb4h2Tck+4Zk35DsG5J9Q7JvSPYNyb4h2Tck+4Zk35DsG5J9
Q7JvSPYNyb4h2Tck+4Zk35DsG5J9Q7JvSPYNyb4h2Tck+4Zk35DsG5J9Q7Jv
SPYNyb4h2Tck+4Zk35DsG/4PkhbeeA==
     "]]}, {}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{364., Automatic},
  Method->{},
  PlotRange->{{-0.00007741640304624578, 
   0.0002754843697160001}, {-0.0003339176320019752, 0.0003339176320019752}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.643529532124421*^9, 3.64352953792974*^9}, 
   3.643539078612447*^9, 3.643540293173831*^9, 3.643542019914706*^9, 
   3.6437016989563007`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<KBHSH3-shadow.dat\>\"", ",", "obsShadow"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.643541079703306*^9, 3.6435410816829977`*^9}, {
   3.643541118713684*^9, 3.643541244105741*^9}, {3.6435420428620777`*^9, 
   3.643542043003867*^9}, {3.643542105209197*^9, 3.6435421501196737`*^9}, {
   3.643542565427125*^9, 3.6435425663434153`*^9}, 3.643544502179902*^9}],

Cell[BoxData["\<\"KBHSH3-shadow.dat\"\>"], "Output",
 CellChangeTimes->{3.6435421507496777`*^9}]
}, Open  ]]
},
WindowSize->{1366, 745},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 508, 8, 31, "Input"],
Cell[1068, 30, 1556, 41, 132, "Input"],
Cell[2627, 73, 1433, 34, 52, "Input"],
Cell[CellGroupData[{
Cell[4085, 111, 1166, 31, 92, "Input"],
Cell[5254, 144, 1641, 23, 30, "Output"],
Cell[6898, 169, 1640, 23, 30, "Output"],
Cell[8541, 194, 1642, 23, 30, "Output"]
}, Open  ]],
Cell[10198, 220, 802, 18, 33, "Input"],
Cell[11003, 240, 5105, 159, 141, "Input"],
Cell[16111, 401, 822, 20, 52, "Input"],
Cell[16936, 423, 1485, 37, 92, "Input"],
Cell[18424, 462, 855, 16, 92, "Input"],
Cell[19282, 480, 4182, 108, 274, "Input"],
Cell[23467, 590, 3499, 85, 132, "Input"],
Cell[26969, 677, 13761, 300, 600, "Input"],
Cell[40733, 979, 10755, 248, 763, "Input"],
Cell[51491, 1229, 635, 17, 54, "Input"],
Cell[52129, 1248, 2274, 58, 174, "Input"],
Cell[54406, 1308, 5372, 140, 254, "Input"],
Cell[59781, 1450, 4810, 114, 434, "Input"],
Cell[64594, 1566, 1390, 37, 152, "Input"],
Cell[CellGroupData[{
Cell[66009, 1607, 1042, 26, 72, "Input"],
Cell[67054, 1635, 654, 13, 23, "Message"],
Cell[67711, 1650, 654, 13, 23, "Message"],
Cell[68368, 1665, 656, 13, 23, "Message"],
Cell[69027, 1680, 594, 12, 23, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69658, 1697, 1161, 35, 112, "Input"],
Cell[70822, 1734, 391, 6, 30, "Output"],
Cell[71216, 1742, 1632, 38, 232, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72885, 1785, 3135, 78, 212, "Input"],
Cell[76023, 1865, 656, 13, 23, "Message"],
Cell[76682, 1880, 656, 13, 23, "Message"],
Cell[77341, 1895, 656, 13, 23, "Message"],
Cell[78000, 1910, 599, 12, 23, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78636, 1927, 1673, 47, 132, "Input"],
Cell[80312, 1976, 860, 13, 30, "Output"],
Cell[81175, 1991, 804, 12, 30, "Output"],
Cell[81982, 2005, 5686, 104, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87705, 2114, 1763, 36, 92, "Input"],
Cell[89471, 2152, 625, 12, 23, "Message"],
Cell[90099, 2166, 625, 12, 23, "Message"],
Cell[90727, 2180, 627, 12, 23, "Message"],
Cell[91357, 2194, 567, 11, 23, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91961, 2210, 1589, 46, 132, "Input"],
Cell[93553, 2258, 444, 7, 30, "Output"],
Cell[94000, 2267, 390, 6, 30, "Output"],
Cell[94393, 2275, 2544, 55, 228, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96974, 2335, 896, 24, 52, "Input"],
Cell[97873, 2361, 1021, 15, 30, "Output"],
Cell[98897, 2378, 7512, 130, 236, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106446, 2513, 2345, 43, 52, "Input"],
Cell[108794, 2558, 1250, 21, 23, "Message"],
Cell[110047, 2581, 1252, 21, 23, "Message"],
Cell[111302, 2604, 1250, 21, 23, "Message"],
Cell[112555, 2627, 1193, 20, 23, "Message"],
Cell[113751, 2649, 732, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114520, 2665, 2827, 84, 192, "Input"],
Cell[117350, 2751, 7110, 129, 379, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124497, 2885, 428, 8, 31, "Input"],
Cell[124928, 2895, 96, 1, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
